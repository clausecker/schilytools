. \" @(#)star.1	1.236 20/09/04 Copyright 1982-2020 J. Schilling
. \"  Manual page for star
. \"
.if t .ds a \v'-0.55m'\h'0.00n'\z.\h'0.40n'\z.\v'0.55m'\h'-0.40n'a
.if t .ds o \v'-0.55m'\h'0.00n'\z.\h'0.45n'\z.\v'0.55m'\h'-0.45n'o
.if t .ds u \v'-0.55m'\h'0.00n'\z.\h'0.40n'\z.\v'0.55m'\h'-0.40n'u
.if t .ds A \v'-0.77m'\h'0.25n'\z.\h'0.45n'\z.\v'0.77m'\h'-0.70n'A
.if t .ds O \v'-0.77m'\h'0.25n'\z.\h'0.45n'\z.\v'0.77m'\h'-0.70n'O
.if t .ds U \v'-0.77m'\h'0.30n'\z.\h'0.45n'\z.\v'0.77m'\h'-0.75n'U
.if t .ds s \(*b
.if n .ds a ae
.if n .ds o oe
.if n .ds u ue
.if n .ds A Ae
.if n .ds O Oe
.if n .ds U Ue
.if n .ds s sz
.ds S SS
.TH STAR 1 "2023/01/11" "J\*org Schilling" "Schily\'s USER COMMANDS"
.SH NAME
star \- unique standard tape archiver
.SH SYNOPSIS
.ie n .B "star\ "
.el .B "star\ \ "
.I command
[\fIoptions\fP]
[\fB\-find\fP]
.I file1 .\|.\|. filen
[\fIfind_expr\fP]
.br
.B ustar
.I command
[\fIoptions\fP]
[\fB\-find\fP]
.I file1 .\|.\|. filen
[\fIfind_expr\fP]
.br
.ie n .B "star\ "
.el .B "star\ \ "
.I command
.BI list= name
[\fIoptions\fP]
\fB\-find\fP
[\fIfind_expr\fP]
.br
.ie n .B "tar\ \ "
.el .B "tar\ \ \ "
.I command
[\fIoptions\fP]
.ie n .B "\ \ \ \ \ \ \ "
.el .B "\ \ \ \ \ \ \ \ \ "
.I file1 .\|.\|. filen
.br
.B "star\ "
.ie n .B "\-copy\ \ "
.el .B "\-copy\ \ \ \ "
[\fIoptions\fP] 
[\fB\-find\fP]
.I file1 .\|.\|.
.ie n [\fIf_expr\fP]
.el \fIfilen\fP [\fIfind_expr\fP]
directory
.br
.B "star\ "
.ie n .B "\-copy\ \ "
.el .B "\-copy\ \ \ \ "
[\fIoptions\fP] 
.B -C
.I "from_directory . to_directory"
.br
.B "star\ "
.ie n .B "cli=\fIname\ \ "
.el .B "cli=\fIname\ \ \ \ "
.I ...
.SH DESCRIPTION
.B Star
is a very fast
.BR tar (1)
like tape archiver with improved functionality.
It supports unlimited path name lengths (up to 8 GB) in all cases that use
suitable archive types.
.PP
.B Star
archives and extracts multiple files to and from a single file
called a 
.I tarfile. 
A 
.I tarfile
is usually a magnetic tape, but it can be any file.
In all cases, appearance of a directory name refers to the files and 
(recursively) subdirectories of that directory.
.PP
.B "Star's"
actions are controlled by the mandatory command flags from the 
list below.
The way 
.B star 
acts may be modified by additional options. 
.PP
Note that unpacking tar archives may be a security risk because 
.B star
may overwrite existing files.
See
.B SECURITY NOTES
for more information.
.PP
If the first argument is in the form
.BI cli= name\fR,
the
.B command line interface
is selected to match
.IR name .
See section
.B CLI\ SELECTION
below.
.SH FEATURES
.B Star
includes the first free implementation of
.B POSIX.1\-2001
extended
.B tar
headers. The
.B POSIX.1\-2001
extended 
.B tar
headers define a new standard way
for going beyond the limitations of the historic 
.B tar
format.
They allow (among others) to archive all UNIX time stamps in sub\-second
resolution, files of arbitrary size and filenames without length limitation
using
.B UNICODE UTF\-8
coding for best exchange compatibility.
.PP
.B Star
by default uses a fifo to optimize data flow from/to tape. This results in 
a normally streaming tape during the whole backup.
See 
.B \-fifo 
and
.B fs=
option to get information on how to find the best fifo size.
.PP
.B Star 
includes a pattern matcher to control the list of files to be 
processed. This gives a convenient interface for archiving and 
restoring complex lists of files. In conjunction with the 
.B \-w 
flag it is easy to merge a
.B tar
archive into an existing file tree. See also 
.B \-U 
option.
In create mode use the 
.B pat=
option to specify either select or exclude patterns (depending on
the 
.B \-V
flag). In extract or list mode 
all file type arguments are interpreted as select patterns while
the patterns specified with the
.B pat=
option may be used as select or exclude patterns (depending on
the 
.B \-V
flag).
Have a look at the description of the
.B \-C
option to learn how to fetch files from a list of directories
(in create mode) or to distribute files to a list of directories
(in extract mode).
A substitute option allows 
.BR ed (1)
like pattern substitution in file names. 
.PP
.B Star
includes support for incremental
.B backup
and
.B restore
similar to the 
.B BSD
commands
.BR dump (1)
and
.BR restore (1)
that are known as 
.BR ufsdump (1)
and
.BR ufsrestore (1)
on Solaris.
.PP
.B Star
includes an enhanced function that is similar to the 
.BR find (1)
command (see
.BR sfind (1)).
This function is implemented in
.BR libfind .
It allows one to use
.B find
expressions, even in extract or list mode, directly on the 
content on an archive.
The extensions to
.BR find (1)
allow one to modify the file metadata.
.PP
.B Star 
includes a sophisticated
.B diff
command that is able to compare file content and meta data.
Several diff options 
allow user tailorable functionality. 
.B Star 
won't show you differences you are not interested in.
Check the 
.B diffopts=
option for more details.
.PP
.B Star 
has no limitation on filename length. Pathnames and linknames up to
.I PATH_MAX
(typically 1024\ bytes) may be archived by most tar implementrations. 
Star allows one to archive path names up to
.B 8 GB
on modern platforms.
.PP
.B Star 
deals with all 3 times, available for files on UNIX systems if the
archive format is either chosen from the star specific formats or
is a format that uses POSIX.1\-2001 extended headers.
This is either done in second resolution by using a star specific
POSIX.1\-1988 compatible extension or in sub second resolution by 
using POSIX.1\-2001 extended headers.
.B Star 
is able to store and restore all 3 times (mtime, atime and even 
ctime). On Solaris 2.x systems - if run as root -, 
.B star 
is able to do backups without changing any of the 3 the times.
.PP
If used with the 
.BI H= ustar 
option, or if called as
.B ustar
or
.B tar
while the
.BR H= headertype
option is not used,
.B star
is 100% POSIX compliant.
.PP
.B "Star's"
default format (if called as
.BR star )
is 
.I xstar
and is as posix compliant as possible. Enhancements to the standard that 
prevent correct extraction of single files when using a different
.B tar 
implementation that is only POSIX.1\-1988 compliant may occur,
but they only affect single files with a pathname that is longer than 100+130 chars 
or when archiving sparse files with the 
.B \-sparse
option in effect.
All other files will extract correctly.
See the description for the
.BI H= headertype
option below for more information on archive formats and possible archive
interchange problems.
.PP
.B Star 
makes it easy to repair corrupted filesystems. After a fsck \-y 
has been run on the filesystem, 
.B star 
is able to restore only 
the missing files automatically. 
Use then 
.I "star \-diff"
to check for differences (see EXAMPLES for more information).
.PP
.B Star 
automatically recognizes the type of the archive.
.B Star 
therefore is able to handle features and properties of different 
archive types in their native mode,
if it knows about the peculiarities of the archive type.
See the 
.BR H= headertype 
option for more details.
To be able to do this, 
.B star
adds hidden fingerprints to the archive header that allows one to recognise
all star specific archive formats. The GNU tar format is recognised by
the way it deviates from the standard.
.PP
.B Star 
automatically recognizes and handles byte swapped archives. There is no 
option to manually control byte swapping.
.PP
.B Star
is able to archive and restore 
.B "Access Control Lists"
for files using POSIX.1\-2001 extended headers.
.SH CLI SELECTION
.PP
If the first argument is in the form
.BI cli= name\fR,
the
.B command line interface
is selected to match one of the supported
.B CLI
variants.
The following interfaces are supported:
.br
.ne 4
.TP 15
.B star
The
.B star
interface selects the command line interface described in this manual page.
.br
.ne 4
.TP
.B suntar
The
.B suntar
interface selects the command line interface of the classical UNIX
.B tar
command as described in
.BR suntar (1).
.br
.ne 4
.TP
.B tar
The classical
.B tar
interface selects the command line interface of the classical UNIX
.B tar
command. This is currently an alias to
.B suntar
and implements extensions introduced by the
.B tar
command found on
.BR Solaris .
.br
.ne 4
.TP
.B gnutar
The
.B gnutar
interface selects the command line interface of the
.B GNU tar
command as described in
.BR gnutar (1).
.B Star
however does not implement the deviations from the standard behavior,
that are caused by the GNU option parser that is used by the original
.BR gtar (1)
command.
.br
.ne 4
.TP
.B pax
The
.B pax
interface selects the command line interface of the
.B POSIX pax
command as described in
.BR spax (1).
.br
.ne 4
.TP
.B cpio
The
.B cpio
interface selects the command line interface of the classical UNIX
.B cpio
command as described in
.BR scpio (1).
.SH COMMAND
.PP
In native mode, 
.B star
is compatible to the command line syntax of a typical POSIX command
and for this reason expects 
.I commands
and
.I options
to start with a single dash (\-). In this case, commands
and options may be specified separately, all boolean or increment type
options may be specified either separately or combined.
.LP
For compatibility with GNU programs, long options may alternatively
start with a double dash.
.LP
In compatibility mode to POSIX
.BR tar ,
.B star
expects commands and options to appear as one single string that does not start
with a dash.
In POSIX tar compatibility mode,
.B additional non POSIX options
may be specified but must appear
.B after
the
POSIX options and their args and need to start with a dash.
.TP
.B \-c
Create a new
.I tarfile
and write named files into it.
Writing starts at the beginning of
.I tarfile.
See \-v option for information on how to increase verbosity while the 
archive is written.
.sp
The Option
.B \-c
may be used together with
.B \-diff
and
.BR \-t .
In this case, the whole command line has to be similar to the
command line for the
.B \-copy
mode.
.TP
.B \-copy
Copy named files to the target directory which is the last file type argument.
The target directory must exist.
The shorthand
.B \-cx
instead of
.B \-copy
is not allowed because this could be a result of a typo.
.sp
If the option
.B \-diff
has been specified in addition,
.B star
performs a one pass directory tree compare instead of copying files.
The shorthand
.B \-c \-diff
instead of
.B \-copy \-diff
is also allowed.
.sp
On operating systems with slow file I/O (such as Linux with any filesystem or
platforms with Copy on Write filesystems like ZFS), it may help
to use
.B \-no\-fsync
in addition (see also
.B ENVIRONMENT
and
.BR FILES ), 
but then
.B star
is unable to detect all error conditions; so use with care.
.sp
If the option
.B \-t
has been specified in addition, the last file type argument is not a 
target directory and 
.B star
is performing a one pass listing instead of copying files.
This makes sense as the listing from
.B star
may be better readable than the output from
.BR "ls \-lR" .
The shorthand
.B \-c \-t
or
.B \-ct
instead of
.B \-copy \-t
is also allowed.
.sp
The job is by default done in the best archive mode.
This implies that it defaults to 
.BR "H=exustar \-dump" .
When in
.B \-copy
mode, 
.B star
forks into two processes and data exchange is done via the shared memory from the FIFO.
This gives the best possible performance.
Without FIFO, the 
.B \-copy
mode will not work.
.sp
The
.B list=
option, patterns and substitutions apply only to the create side of the copy command.
.TP
.B \-diff
Compare the content and the attributes of the files from the archive in
.I tarfile
to the filesystem.
This may also be used to compare two file trees in the filesystem.
If you use a set of
.I diffopts
that fits your needs, it will give
- in many cases - a more readable output than diff \-r.
If you use
.B star's
dump extensions for the tar archive, the 
.B \-diff
option allows one to find even if the directory in the file tree
contains more files than the archive. This way, it is possible to
compare all properties of two file trees in one run.
See 
.I diffopts 
for more details.
Adding one or more 
.B \-v
options increases the verbosity. With
.B \-vv
and above, the directory content is compared also if
.B star
is reading a tar archive that has been created in 
.B \-dump
mode.
.TP
.B \-n
No extraction. Show what 
.B star 
would do, in case the
.B \-x
command had been specified.
.TP
.B \-r
Replace files in a
.I tarfile.
The named files are written to the end of
.I tarfile.
This implies that later,
the appropriate files will be found more than once on the 
.I tarfile.
.TP
.B \-t
Table of contents.
List the contents of the
.I tarfile.
If the \-v flag is used, the listing is similar to the format of ls \-l output.
With this option, the flags
.BR \-a ,
.B \-atime
and
.B \-ctime
have a different meaning if the archive is in 
.BR star ,
.BR xstar ,
.BR xustar ,
.BR exustar ,
or
.BR pax / epax 
format.
The option
.B \-a
or
.B \-atime
lists the access time instead of the modification time, the option
.B \-ctime
lists the file creation time instead of the modification time.
The option 
.B \-tpath
may be used in addition to modify the output so it may be used in shell scripts.
.TP
.B \-u
Update a
.I tarfile.
The named files are written to the end of
.I tarfile
if they are not already there or if the files are newer than the files
of the same name found in the archive.
The \-r and \-u command only work if the
.B tar
archives is a regular file or
if the
.B tar
archive is an unblocked tape that may backspace.
.TP
.B \-x
Extract the named files from the
.I tarfile.
If no filename argument or pattern is specified, the entire content of the
.I tarfile
is restored.
If the \-U flag is not used, 
.B star 
extracts no file which is older than the corresponding file on disk.
.sp
On operating systems with slow file I/O (such as Linux with any filesystem or
platforms with Copy on Write filesystems like ZFS), it may help
to use
.B \-no\-fsync
in addition (see also
.B ENVIRONMENT
and
.BR FILES ), 
but then
.B star
is unable to detect all error conditions; so use with care.
.PP
Except for the shorthands documented above,
exactly one of the commands above must be specified.
.PP
If one or more patterns or substitution commands have been specified,
they apply to any of the command listed above.
In copy mode, all patterns and substitute commands apply to the create side.

.SH OPTIONS
.TP
.B \-help
Print a summary of the most important options for
.BR star (1).
.TP
.B \-xhelp
Print a summary of the less important options for
.BR star (1).
.TP
.B \-/
Don't strip leading slashes from file names when extracting an archive.
Tar archives containing absolute pathnames are usually a bad idea. 
With other 
.B tar 
implementations, 
they may possibly never be extracted without clobbering existing files. 
.B Star 
for that reason, by default strips leading slashes from filenames 
when in extract mode.
As it may be impossible to create an archive where leading slashes have
been stripped while retaining correct path names, 
.B star
does not strip leading slashes in create mode.
.sp
See
.B SECURITY NOTES
for more information.
.TP
.B \-..
Don't skip files that contain /../ in the name. Tar archives containing
names with /../ could be used to compromise the system. If they are
unpacked together with a lot of other files, this would in most cases not
even be noticed. For this reason, 
.B star
by default does not extract files that contain /../ in the name if
.B star
is not in interactive mode (see
.B \-w
option).
.sp
See
.B SECURITY NOTES
for more information.
.TP
.B \-7z
Run the input or output through a
.B p7zip
pipe.
See section
.B COMPRESSION
for details.
.TP
.B \-0
.TP
.B \-1
.TP
.B \-2
.TP
.B \-3
.TP
.B \-4
.TP
.B \-5
.TP
.B \-6
.TP
.B \-7
Select an archive entry from 
.BR /etc/default/star .
The format for the archive entries is the same as the format in
.B /etc/default/tar
in Solaris.
.TP
.B \-acl
Handle 
.B "Access Control List"
(ACL) information in create and extract mode.
If
.B \-acl
has been specified,
.B star 
is in create mode and the header type is 
.BR exustar ", " star
will add ACL information to the archive using POSIX.1\-2001 extended headers.
If
.B \-acl
has been specified and
.B star 
is in extract mode,
.B star
will try to restore ACL information. If there is no ACL information for
one or all files in the archive,
.B star
will clear the ACL information for the specific file.
Note that if
.B \-acl
has not been specified,
.B star
will not handle ACL information at all and files may inherit ACL
information from the parent directories.
If the 
.B \-acl
option has been specified,
.B star
assumes that the
.B \-p
option has been specified too.
.sp
Star currently supports
.B ACLs
from the
.B withdrawn POSIX.1e draft
and
.BR "NFSv4 ACLs" .
To check which ACL flavors are supported on the current platform, call
.BR "star \-version" .
Whether ACLs from the withdrawn POSIX.1e draft can be converted into NFSv4 ACLs
depends on the local ACL support library.
.TP
.BI artype= headertype
Generate a tape archive in
.I headertype
format.
If this option is used in extract/list mode this forces 
.B star
to interpret the headers to be of type 
.I headertype.
As 
.B star
even in case of a user selected extract archive format does format checking,
it may be that you will not be able to unpack a specific archive with all
possible forced archive formats. Selecting the old
.B tar
format for extraction will always work though.
Valid parameter for 
.I headertype
are:
.RS
.TP 10
.B help
Print a help message about possible header types.
.TP 10
.B v7tar
Old UNIX V7
.B tar
format. 
This archive format may only store plain files.
Pathnames or linknames longer than 99 chars may not be archived.
.sp
If the
.B v7tar
format has been selected, 
.B star
will not use enhancements to the historic UNIX V7 tar format.
File size is limited to 2 GB - 2 bytes, uid/gid is limited to 262143.
Sparse files will be filled up with zeroes.
.TP 10
.B tar
Old BSD UNIX
.B tar
format. 
This archive format may only store plain files, directories and 
symbolic links.
Pathnames or linknames longer than 99 chars may not be archived.
See also the 
.B \-d
option as a note to some even older tar implementations.
.sp
If the
.B tar
format has been selected, 
.B star
will not use enhancements to the historic tar format.
File size is limited to 2 GB - 2 bytes, uid/gid is limited to 262143.
Sparse files will be filled up with zeroes.
.TP 10
.B star
Old 
.B star 
standard format. This is an upward/downward compatible 
enhancement of the 
.I old 
(pre Posix) UNIX
.B tar
format.
It has been introduced in 1985 and therefore is not Posix compliant.
The
.B star
format allows one to archive special files (even sockets) and records access time and
creation time besides the modification time. Newer versions of the old 
.B star 
format allow very long filenames (100+155\ chars and above), linknames > 100 chars
and sparse files (if
.B \-sparse
is used).
This format is able to copy the device nodes on HP\-UX
that have 24 bits in the minor device number, which is more then the 21 bits
that are possible with the POSIX\-1003.1\-1988 archive format.
.sp
The nonstandard extensions are located in the space between the link name and
the POSIX file name prefix.
As the
.B star
format does not use a POSIX magic string, the extensions do not interfere
with the POSIX tar formats.
The last 4 bytes of the
.B tar
header in the
.B star
archive format contain a
.B
\&'tar\e0'
signature.
.sp
This archive format supports very long path names.
.TP 10
.B gnutar
This is a commonly used, but unfortunately not Posix compliant
(although designed after 1987)
enhancement to the old
.B tar 
format.
The 
.B gnutar
format has been defined between 1989 and 1994.
Do not use the
.B gnutar
archive format unless you want to create an archive for a target system
that is known to have only the gnutar program available.
The
.B gnutar
archive format violates basic rules for any (even the historic) tar archive
format, in special when sparse files are archived using the
.B \-sparse
option.
.sp
.B GNU tar
is not able to extract files with with long path names, but under some conditions
creates archives with long path names. We therefore do not limit the creation of
.B gnutar
archives with long path names.
.sp
Using the
.B gnutar
archive format causes a high risk that the resulting archive may only be read
by gnutar or by
.BR star .
The implementation of the gnutar archive format within 
.B star
is not complete, but 
sufficient for most gnutar archives.
See NOTES for more information.
.sp
This archive format supports very long path names.
.TP 10
.B ustar
IEEE/Posix1003/IEC\-9945\-1\-1988 Standard Data Interchange format.
With this option in effect, 
.B star 
will generate 100% POSIX.1\-1988 compliant 
.B tar
archives.
Files with pathnames longer than 100+155 chars or linknames longer than
100 chars may not be archived.
If 
.B star
is called as
.B ustar
the default archive format is
.BR ustar .
.sp
If the
.B ustar
format has been selected, 
.B star
will not use enhancements to the POSIX.1\-1988 tar format, the archive
will be strictly conforming.
File size is limited to 8 GB, uid/gid/major/minor is limited to 2097151.
Sparse files will be filled up with zeroes.
.TP 10
.B pax
The IEEE/Posix1003/IEC\-9945\-1\-1988 successor is
the POSIX\-1003.1\-2001 Standard Data Interchange format.
It is called the
.B pax
archive format.
.sp
If the
.B pax
format has been selected, 
.B star
will not use enhancements to the POSIX.1\-2001 tar format, the archive
will be strictly conforming.
File size is unlimited, uid/gid/uname/gidname is unlimited,
major/minor is limited to 2097151.
Sparse files will be filled up with zeroes.
.sp
This archive format supports very long path names.
.TP
.B epax
A format similar to the
.B pax
format but with forced POSIX.1\-2001 extended headers.
This enforces stimestamps with nanosecond resolution in the archive.
.sp
This archive format supports very long path names.
.TP 10
.B xstar
The extended standard
.B tar
format has been introduced in 1994.  
.B Star
uses the
.B xstar
format as default archive format. 
This is an upward/downward compatible enhancement 
of the IEEE/Posix1003/IEC\-9945\-1 Standard Data Interchange format.
It allows among others very long filenames (100+130\ chars and above) 
and records access time and creation time.
Sparse files will be archived correctly (if
.B \-sparse
is used).
.sp
The access time and creation time are stored at the end of the POSIX
file name prefix (this limits the prefix to 130 chars).
These extensions do not interfere with the POSIX standard as the
fields for mtime and ctime field are always separated from the 
POSIX file name prefix by a null byte.
The last 4 bytes of the
.B tar
header contain a 
.B
\&'tar\e0'
signature.
.sp
The 
.B xstar
format is the default format when
.B star
is neither called as
.B tar 
nor called as
.BR ustar .
.sp
This archive format supports very long path names.
.TP
.B xustar
A new format introduced 1998, that omits the
.B
\&'tar\e0'
signature at the end of the
.B tar
header. It is otherwise identical
to the
.B xstar
format.
As some
.B tar
implementations do not follow the POSIX rules and compute
the checksum for less than 512 bytes of the
.B tar
header, this format may help
to avoid problems with these broken
.B tar
implementations.
The main other difference to the
.B xstar
format is that the
.B xustar
format uses POSIX.1\-2001 extended headers to overcome limitations of the
historic
.B tar
format while the
.B xstar
format uses proprietary extensions.
The 
.B xustar
format is the default format when
.B star
is called as
.BR tar .
.sp
File size is unlimited, uid/gid/uname/gidname is unlimited,
major/minor is unlimited.
Sparse files will be archived correctly (if
.B \-sparse
is used).
.sp
This archive format supports very long path names.
.TP
.B exustar
A format similar to the
.B xustar
format but with forced POSIX.1\-2001 extended headers.
If this format is used together with the
.B \-acl
option,
.B star
records Access Control Lists (ACLs) in POSIX.1\-2001 extended headers.
.sp
The
.B exustar
format allows one to archive all file types but it does not
archive more than the POSIX.1-1988 set by default.
If the
.B \-dump
option is used or if
.B star
is otherwise on dump mode, star archives all file types
and in addition archives more meta data then usual.
.sp
File size is unlimited, uid/gid/uname/gidname is unlimited,
major/minor is unlimited.
Sparse files will be archived correctly (if
.B \-sparse
is used).
.sp
This archive format supports very long path names.
.TP
.B suntar
The extended header format found on Solaris 7/8/9. This format is similar to the
.B pax
format but does not handle 
.I atime
and
.I ctime
and in addition uses 'X' as the typeflag for the extended headers instead of
the standard 'x'.
.sp
File size is unlimited, uid/gid/uname/gidname is unlimited,
major/minor is unlimited.
Sparse files will be filled up with zeroes.
.TP
.B bin
The cpio UNIX V7 binary format.
This is a format with big interoperability problems. Try to avoid this format.
It is only present to make the
.B scpio
command SVr4 compliant.
.TP
.B cpio
The POSIX.1-1988 
.B cpio
format. This format uses octal ascii headers. A similar format is
created by calling
.I "cpio \-o \-c"
on pre SYSVr4 systems and by calling
.I "cpio \-o \-Hodc"
on SYSVr4 systems.
The POSIX.1-1988 
.B cpio
format allows a file name length up to 262142 characters and allows one to
archive nearly any file type.
File size is limited to 8 GB, uid/gid/st_dev is limited to 262143.
The way major and minor device numbers are stored inside the st_dev
field is implementation dependent.
.sp
Even though this archive format is covered by the POSIX.1-1988 standard,
it has a lower portability than the
.B ustar
format. Try to avoid the 
.B cpio
archive format.
.TP
.B odc
This archive format is similar to the The POSIX.1-1988
.B cpio
format but the file name length is limited to 255 characters and
the socket file type is not allowed.
This archive format has been introduced to allow non POSIX cpio implementations
such as the cpio program on SYSV to accept the archive. Use this
format whenever you are not sure if the target system offers a fully POSIX
compliant cpio program.
.sp
Even though this archive format is covered by the POSIX.1-1988 standard,
it has a lower portability than the
.B ustar
format. Try to avoid the 
.B odc
archive format.
.TP
.B asc
Tell
.B star
to create a
.B cpio
archive in the ascii format that is created with
.I "cpio \-o \-c"
on SYSVr4 systems.
It uses extended (32 bit) numbers for uid's, gid's and device numbers
but limits the file size to 4 GB - 2 bytes although the format has been
specified after the POSIX.1-1988 cpio format.
Try to avoid the
.B asc
archive format because of its limited portability.
.TP
.B crc
This format is similar to the
.B asc
cpio format but in addition uses a simple byte based 32-bit checksum.
Hence the archive type name
.B CRC
as used by AT&T is misleading.
Try to avoid the
.B crc
archive format because of its limited portability.

.PP
All
.B tar
archive formats may be interchanged if the archive contains 
no files that may not be archived by using the old
.B tar
format. 
Archives in the 
.I xstar 
format may be extracted by any 100% POSIX compliant
.B tar
implementation if they contain no files with pathnames >\ 100+130\ chars 
and if they contain no sparse files that have been archived by using 
the 
.B \-sparse
option.
.RE

.TP
.B \-ask_remove
obsoleted by \-ask\-remove
.TP
.B \-ask\-remove
Ask to remove non writable files on extraction.
By default, 
.B star
will not overwrite files that are read only.
If this option is in effect, 
.B star
will ask whether it should remove these files to allow the extraction of a file
in the following way:
.RS
.IP
.BI "remove '" filename "' ? Y(es)/N(o) :"
.RE
.TP
.BR \-atime ", " \-a
Reset access time of files after storing them to 
.I tarfile.
On Solaris 2.x, (if invoked by root) 
.B star 
uses the 
.I _FIOSATIME 
ioctl to do this. This enables 
.B star 
not to trash the 
.I ctime
while resetting the
.I atime
of the files.
If the
.B \-atime
option is used in conjunction with the list command, 
.B star 
lists access time instead of modification time. (This works only in 
conjunction with the
.BR star ,
.BR xstar ,
.BR xustar ,
.BR exustar ,
and with the 
.BR pax / epax
format.)
Another option to retain the access time for the the files that
are going to be archives is to readonly mount a 
.B "UFS snapshot"
and to archive files from the mount point of the UFS snapshot.
.TP
.B \-B
Force 
.B star
to perform multiple reads (if necessary) to fill a block.
This option exists so that 
.B star 
can work across the Ethernet, since pipes and sockets return partial blocks 
even when more data is coming.
If 
.B star
uses 
.I stdin
as archive file, 
.B star
behaves as if it has been called with the 
.B \-B
option.
For this reason, the option \-B in practice is rarely needed.
.TP
.BI b= "#"
Set the block size for tape operations.
See option
.BI blocks= #\c
\&.
.TP
.B \-block\-number
Print the archive block number (archive offset / 512) at the beginning of
each line when in verbose mode. This allows one to write backup scripts
that archive the offsets for files and that use
.sp
.BI "	mt fsr" " blockno" 
.sp
to skip to the tape block number of interest in a fast way
if a single file needs to be restored.
.sp
Since the numbers printed by the
.B \-block\-number
option are based on a block size of 512 bytes and the tape block size is
usually larger, the tape block number for the
.B mt fsr
command needs to be computed to honor the tape blocking factor.
.TP
.BI blocks= "#\fR, " b= "#"
Set the blocking factor of the 
.I tarfile
to #\ times 512\ bytes (unless a different multiplication factor has 
been specified - see 
.B bs=
option for possible multiplication factors).
Changing the blocking factor only makes sense
when the archive is located on a real tape device or when
the archive is accessed via the remote tape protocol (see
.B f=
option below).
The default is to use a blocking factor of 20 i.e. 
10\ kBytes.
Increasing the blocksize will speed up the backup.
For portability with very old
.B tar
implementations (pre BSD\ 4.2 or pre AT&T\ SVR4),
blocksize should not be more than 10\ kBytes.
For POSIX.1\-1988 compatibility, blocksize should be no more than 10\ kBytes.
For POSIX.1\-2001 compatibility, blocksize should be no more than 32\ kBytes.
Most systems also have a hardware limitation for the blocksize, 32\ kBytes
and 63\ kBytes are common limits on many systems.
The upper limit in any case is the size of the buffer RAM in the tape drive.
Make a test if you want to make sure that the target system will handle
the intended blocksize.
If you use 
.B star
for data exchange via tape, it is a good idea to use a blocksize of 10\ kBytes
unless you are sure that the reading system will handle a larger blocksize.
If you use 
.B star
for backup purposes with recent hardware (e.g. DLT tape drives),
a blocksize of 256\ kBytes
results in sufficient speed and seems to be a good choice.
.B Star
allows block sizes up to 2 GByte if the system does not impose a smaller limit.
If you want to determine the blocking factor when reading an unknown
.B tar
archive 
on tape, specify a blocking factor that is higher than the supposed 
blocking factor of the tape. 
.B Star 
then will determine the blocking factor 
by reading the first record of the tape and print a message:
.RS
.IP
.B 
star: Blocksize = # records.
.PP
Where # is the blocking factor in multiples of 512 bytes.
The
.I blocks=
option 
and the
.I bs=
option are equivalent methods to specify the tape block size.
The 
.B blocks= 
option is preferred by people who like to use an option that behaves
similar to the interface of the historic
.BR tar (1)
implementations.
.sp
The best method to set the blocksize is to use the
.BI bs= #
option.
.RE
.TP
.BI bs= #
Set output block size to #.
You may use the same method as in 
.BR dd (1)
and
.BR sdd (1).
The number representing the size is taken in bytes unless otherwise specified.
If a number is followed directly by the letter `.', `w', `b', `k', `m', `g',
`t', or `p',
the size is multiplied by 1, 2, 512, 1024, 1024*1024, 1024*1024*1024,
1024*1024*1024*1024 or 1024*1024*1024*1024*1024.
If the size consists of numbers separated by `x' or `*', multiplication of the 
two numbers is performed.
Thus 
.I "bs=7x8k"
will specify a blocksize of 56\ kBytes.
Blocksize must be a multiple of 512 bytes.
See also the description of the
.I blocks=
option for more details on blocksizes.
The option
.B bs=
is preferred by people who like to use an option that behaves
similar to the interface used by
.BR dd (1)
and
.BR sdd (1).
.TP
.B \-bsdchdir
Switch the behavior of the 
.B C=
option to BSD style.
The default behavior of
.B star
is to stay in a working directory until a new 
.B C=
is seen.
With BSD tar, the
.B C=
option is only related to the next file type argument.
.TP
.B \-bz
Run the input or output through a 
.B bzip2
pipe.
This option is an alias for
.BR \-j .
See section
.B COMPRESSION
for details.
.TP
.BI C= dir
.TP
.BI \-C " dir"
Perform a 
.BR chdir (2)
operation to 
.I dir
before storing or extracting the next files.
In all cases, 
.B star 
will perform the
.BR chdir (2)
operation relative to the current working directory of the shell.
.RS
.TP
.B \(bu
In list mode (with the 
.B \-t
flag),
.B star
ignores all 
.I \-C
options.
.TP
.B \(bu
In create mode (with the 
.BR \-c ", " \-r " and " \-u
flag),
.B star
walks through all 
.I \-C
options and file type arguments.
While a BSD derived
.BR tar (1)
implementation
goes back to the current working directory after storing
one file argument that immediately follows the
.I \-C
option,
.B star
changes the directory only if a new
.B \-C
option follows.
To emulate the behavior of a BSD derived
.BR tar (1),
add a
.BI \-C " ."
option after the file argument.
.TP
.B \(bu
In extract mode (with the 
.BR \-x ", " \-n " and " \-diff
flag),
.B star
builds a pattern list together with corresponding directories 
from previous 
.BI C= dir
options and performs a
.BR chdir (2)
to the corresponding directory of a matching pattern.
All 
.B pat=
options that do not follow a
.BI C= dir
option are interpreted as if they were preceded by a 
.BI \-C " ."
option.
See EXAMPLES for more information. 
.RE
.TP
.BI compress-program= name
Set a named compress program.
See section
.B COMPRESSION
for details.
.TP
.B \-copydlinks
Try to recursively copy the content of linked directories instead of
creating the link. This is an experimental feature that may help
to unpack archives on DOS.
.TP
.B \-copyhardlinks
This option allows one to copy hardlinked targets
rather than creating the link.
It helps to extract
.B tar
files on systems that do not implement
hardlinks (e.g. BeOS).
.TP
.B \-copylinks
This option allows one to copy both, hard- and symlinked targets
rather than creating a link.
It helps to extract
.B tar
files on systems that do not implement
links (e.g. OS/2).
To extract and copy all symlinks correctly, you may need to call
.B star
twice as 
.B star
cannot copy files that appear in the archive later than a symlink
pointing to them.
.TP
.B \-copysymlinks
This option allows one to copy symlinked targets
rather than creating a symbolic link.
It helps to extract
.B tar
files on systems that do not implement
links (e.g. OS/2).
To extract and copy all symlinks correctly, you may need to call
.B star
twice as 
.B star
cannot copy files that appear in the archive later than a symlink
pointing to them.
.TP
.B \-cpio\-statistics
Instead of the 
.B star 
flavor of the statistics, print statistics in 
.B cpio
flavor.
.TP
.B \-ctime
If used with the list command, this lists 
.I ctime 
rather than 
.I mtime
if the archive format is
.BR star ,
.BR xstar ,
.BR xustar ,
.BR exustar ,
or
.BR pax / epax .
.sp
If star is run as root and if
.B \-ctime 
is used with the extract command and the same archive formats,
this causes
.B star
to try to restore even the 
.I ctime 
of a file by generating time storms.
You should not do this when in multi user mode because this may 
confuse programs like cron and the news system.
Although 
.B star
tries to eliminate the accumulative effects of the time storm,
there is a tendency for the system clock to slow down a bit.
The clock typically lags about one millisecond per extracted file.
Use with care and check the system clock after using this feature.
.sp
If used with the create command this changes the behavior of the
.I newer=
option. 
.BR Star , 
in this case compares the
.I ctime
of all files to the 
.I mtime
of the stamp file rather then comparing the
.I mtimes
of both files.
.TP
.B \-cumulative
A shorthand for
.BR \-dump\-cumulative .
See 
.B \-dump\-cumulative
for more information.
.TP
.B \-D
Do not descend directories when in create mode.
Normally, 
.B star 
descends the whole tree if it encounters a directory in 
in its file parameters.
The option 
.B \-D
is in effect by default if the 
.BI list= file
option is used.
If you like 
.B star
to descend directories found in the list file, use the
.B \-dodesc
option (see below).
.TP
.B \-d
Do not store/create directories.
Old versions of 
.B tar 
such as published with the seventh edition of UNIX
are not able to deal with directories in
.B tar
archives. 
If a
.B tar
archive is generated without directories this avoids
problems with
.B tar
implementations found on SYSVr3 and earlier.
If used during extract, no intermediate missing directories are created.
.TP
.B \-data\-change\-warn
If the size of a file changes while the file is being archived, treat this
condition as a warning only that does not cause a non zero exit code.
A warning message is still written if the condition is not otherwise
ignored by another rule from an
.B errctl=
option.
The
.B \-data\-change\-warn
option works as if the last error control option was
.sp
	\fBerrctl=\fP\fI"WARN|GROW|SHRINK	*"\fP
.sp
The
.B \-e
option or an
.B ABORT
entry in a condition set up by
.B errctl=
has a higher precedence than the
.B \-data\-change\-warn
option.
This option is ignored in extract or list mode.
.TP
.B \-debug
Print debug messages. Among other things, this gives debug messages for
header type recognition,
.B tar
type properties, EOF recognition, opening 
of remote archives and fifo internals.
.TP
.BI diffopts= optlst
Comma separated list of diffopts.
Valid members in
.I optlst
are:
.RS
.TP 10
.B help
Print a summary of possible members of the diffopts list.
.TP 10
.B !
Invert the meaning of the following string. No comma is needed after the 
exclamation mark.
.TP 10
.B not
Invert the meaning of all members in the diffopts list i.e. exclude 
all present options from an initially complete set compare list.
When using 
.BR csh (1)
you might have problems to use 
.B !
due to its strange parser.
This is why the 
.B not
alias exists.
.TP 10
.B perm
Compare file permissions. With this option in effect, 
.B star 
compares the low order 12 bits of the st_mode field.
.TP 10
.B mode
Same as 
.I perm.
.TP 10
.B symperm
Compare permissions even in case the target file on the local
filesystem is a symbolic link.
By default,
.B star
will not compare the permission of symbolic links
as most systems cannot set the permission
of symbolic links.
.B Star
compares
.B symperm
only if
.B perm
is compared also.
.TP 10
.B type
Compare file type. 
Note that 
.B star
cannot compare the file type in case of a hard link.
.TP 10
.B nlink
Compare link count on hardlinks for all types of files.
This only works if the archive is in
.B exustar
format and contains
.B star's
dump extensions.
.TP 10
.B dnlink
Compare link count on hardlinks for directories.
If comparing 
.B dnlink
is excluded but
.B nlink
is not excluded, this allows one to deal with filesystems that differ
in their directory implementation.
The link count of directories in POSIX is equal to the number of manually
created additional hard links + 1 (as with other file types), while on
historical UNIX filesystems it is equal to the number of 
sub-directories + 2 + number of manually created additional hard links.
This only works if the archive is in
.B exustar
format and contains
.B star's
dump extensions.
.TP 10
.B uid
Compare numerical user id of file.
.TP 10
.B gid
Compare numerical group id of file.
.TP 10
.B uname
Compare ASCII version of user id of file.
The user name is mapped via the file /etc/passwd.
.TP 10
.B gname
Compare ASCII version of group id of file.
The group name is mapped via the file /etc/group.
.TP 10
.B id
Shorthand for:
.IR "uid,gid,uname,gname" .
Compare all user/group related info of file.
Note that this will always find differences if the source and
target system use different user or group mappings.
.TP 10
.B size
Compare file size.
Note that 
.B star
cannot compare the file size in case of a hard link.
.TP 10
.B data
Compare content of file.
If
.B star
already found that the size of the files differ, it will not
compare the content anymore.
If the size of the files differ,
.B star
will always report different data.
.TP 10
.B cont
Same as 
.I data.
.TP
.B rdev
Compare major/minor numbers for device nodes.
.TP 10
.B hardlink
Compare target of hardlinks.
.TP 10
.B symlink
Compare target of symlinks. This evaluates the paths returned by the 
readlink(2) call.
.sp
Two symlinks are considered equal, it they either have a characterwise
identical link-name, or if they either both use an absolute path name
or both use a relative path name and the following is true:
Both symlinks point to the same file that must exist or both pathnames look
similar enough.
.TP 10
.B sympath
Compare the target pathnames of symlinks. This characterwise compares 
the strings returned from the readlink(2) call.
.TP 10
.B sparse
Compare if either both files are sparse or not. If only one of both files
is sparse, then a difference is flagged.
This only works with if the archive format is
.BR star ,
.BR xstar ,
.BR xustar ,
.BR exustar ,
or
.BR gnutar .
.TP 10
.B atime
Compare access time of file. 
This only works with if the archive format is
.BR star ,
.BR xstar ,
.BR xustar ,
.BR exustar ,
or
.BR pax / epax .
.TP 10
.B mtime
Compare modification time of file.
.TP 10
.B ctime
This only works with if the archive format is
.BR star ,
.BR xstar ,
.BR xustar ,
.BR exustar ,
or
.BR pax / epax .
.TP 10
.B lmtime
Compare the modification time 
even in case the target file on the local filesystem is a
symbolic link.
By default,
.B star
will not compare the modification time of symbolic links
as most systems cannot set the modification time
of symbolic links.
.B Star
compares
.B lmtime
only if
.B mtime
is compared also.
.TP 10
.B times
Shorthand for:
.IR "atime,mtime,ctime" .
.TP
.B nsecs
Check nanoseconds in all selected timestamps as well.
.sp
Note that the time resolution of various filesystem differs.
While modern filesystems like
.B ZFS
and filesystems that introduced a sub-second resolution recently,
tend to support a nanosecond granularity, filesystems like
.B UFS
that support a sub-second resolution since the early 1990s tend to
support only a microsecond granularity. Since even in in 2018,
the POSIX.1-2008 feature
.B pathconf(_PC_TIMESTAMP_RESOLUTION)
has not yet been implemented on any platform, you may need to disable
to compare nanoseconds in some cases.
.sp
.B Star
currently first tries to compare the timestamps based on a nanosecond
resolution and if that fails and one timestamp seems to have a microsecond
resolution, the comparison is repeated with microsecond resolution only.
.TP 10
.B dir
Compare the content of directories.
This only works if the archive is in
.B exustar
format and contains
.B star's
dump extensions.
Together with increased verbose level
.RB ( \-vv )
this will print a list of files that are only in the archive and a list of files
that are only on the current filesystem.
.TP 10
.B xtimes
Shorthand for:
.IR "atime,mtime,ctime,lmtime" .
.TP 10
.B acl
Compare access control lists.
This only works if the archive is in
.B exustar
format and has been created with
.B star's
.B \-acl
option.
You need to specify the
.B \-acl
option in addition when running the diff.
.TP 10
.B xattr
Compare extended file attributes.
This only works if the archive is in
.B exustar
format and has been created with
.B star's
.B \-xattr
option.
You need to specify the
.B \-xattr
option in addition when running the diff.
.TP 10
.B fflags
Compare extended file flags.
This only works if the archive is in
.B exustar
format and has been created with
.B star's
.B \-xfflags
option.
You need to specify the
.B \-xfflags
option in addition when running the diff.
.PP
If 
.I optlst
starts with a ! the meaning of all members in 
.I optlst
is inverted as with the 
.I not
optlist member.
In this case,
.B star
starts with a complete list that includes
.B atime
and
.BR lmtime .
Reasonable diff options to use when comparing against a copy of a
directory tree are
.BR diffopts=!atime,ctime,lmtime .
.PP
If 
.I diffopts
are not specified, 
.B star 
compares everything but the access time of the files
and the modification time of symbolic links.
.RE
.TP
.BI dir-group= group
If 
.B star
extracts archives as root, this option allows one to control the group id of
intermediate directories created by
.BR star .
.TP
.BI dir-owner= user
If 
.B star
extracts archives as root, this option allows one to control the owner of
intermediate directories created by
.TP
.B \-dirmode
If in create mode (i.e. when storing files to archive),
.B star 
stores directories past the corresponding files. This guarantees that even old 
.B tar
implementations without a directory cache will be able to restore the
correct times of directories.
The option
.B \-dirmode
should only be used if the archive needs to be extracted by an old
.B tar
implementation. If
.B star
is used to extract an archive that has been created with
.B \-dirmode
the directories will not get an old time stamp unless the option
.B \-U
is used while extracting the archive.
.TP
.B \-do\-fsync
Tell
.B star
to call
.BR fsync(2)
for every file when in extract mode.
This enables
.B star
to check whether a file could be successfully extracted.
See
.B \-no\-fsync
for more information.
.TP
.B \-dodesc
Force 
.B star
to descend directories found in a
.BI list= file.
See also the 
.B \-D
option above.
The
.B \-dodesc
option only works in create mode.
.TP
.B \-dump
Allows creating archives with the same number of attributes as an archive that
has been created with the 
.B level=
option but without the restrictions that apply to a true dump.
.sp
The resultant archive may be seen as a 
.I level-less
dump which includes similar attributes as a level 0 dump but may span more than 
a single file system and does not need to use a
.B \-C
option.
It has been originally introduced to make it easier to implement a
.B star
version that supports
.IR "true incremental dumps" ,
but it is kept as it gives additional benefits.
.B Star
currently sets the archive type to
.B exustar
and, in addition archives more inode meta data inside POSIX.1-2001 extended headers.
See also
.B level=
option and the section
.B "INCREMENTAL BACKUPS"
for more information on
.IR "true incremental dumps" .
.TP
.B \-dump+
Works similar to
.B \-dump
but creates more global archive header meta data, e.g. the
.B SCHILY.volhdr.hostname
tag.
.sp
This helps to understand where a tar archive has been created.
.TP
.B \-dump\-cumulative
instructs
.B star
to perform incremental dumps relatively to the last incremental dump of the same level.
Incremental dumps with a level higher than 0 are normally done relatively to
the content of a previous dump with lower level. If incremental dumps and restores
are going to be used to synchronize filesystem content, every successive incremental
dump will increase in size if 
.B \-dump\-cumulative
is not used.
See section
.B "SYNCHRONIZING FILESYSTEMS"
for more information.

.TP
.BI dumpdate= name
Tells
.B star
to use the 
.B mtime
of the time stamp file
.I name
instead of using the start time of 
.BR star .
This is needed when 
.B star
is run on file system snapshots.
If
.B star
would use the the it's own start time with snapshots, all files that
have been modified between the setup of the snapshot and the start
of
.B star
would be missing on the backup.
.sp
A solution is to create the time stamp file, then to create the snapshot
and later use the option
.BI dumpdate= name.
.TP
.B \-dumpmeta
changes the behavior of
.B star
in incremental dump mode.
If 
.B \-dumpmeta
is used and only the inode change time (st_ctime) of a file has been
updated since the last incremental dump,
.B star
will archive only the
.B meta
data of the file (e.g. uid, permissions, ...) but not the
file content.
Using
.B \-dumpmeta
will result in smaller incremental dumps, but files that have been created
between two incrementals and set to an old date in st_mtime (e.g. as a result
from a tar extract) will not be archived with full content.
Using
.B \-dumpmeta
thus may result in incomplete incremental dumps,
use with extreme care.
.TP
.B \-e
Exit immediately with exit status \-3 (253) if any unexpected error occurs.
The
.B \-e
option works as if the last error control option was
.sp
	\fBerrctl=\fP\fI"ABORT|ALL|DIFF	*"\fP
.sp
This allows one to use the
.B errctl=
option together with the
.B \-e
option and thus to ignore some error conditions while aborting on all
other conditions.
.TP
.PD 0
.BI errctl= " name"
.TP
.BI errctl= " error control spec"
.PD
Add the content from file
.I name
to the error control definitions or add
.I error control spec
to the error control definitions.
More than one error control file and more than one
.I error control spec
as well as a mixture of both forms is possible. 
.sp
The reason for using error control is to make
.B star
quiet about error conditions that are known to be irrelevant on the quality 
of the archive or restore run or to tell 
.B star 
to abort on certain error conditions instead of trying to continue
with the archive.
.sp
.ne 6
A typical reason to use error control is to
suppress warnings about growing log files while doing a backup on a
live file system.
Another typical reason to use error control is to tell
.B star
to abort if e.g. a file could not be archived instead of continuing
to archive other files from a list.
.sp
The error control file contains a set of lines, each starting with a list
of error conditions to be ignored followed by white space followed by a
file name pattern (see 
.BR match (1)
or
.BR patmatch (3)
for more information).
The
.I error control spec
uses the same syntax as a single line from the error control file.
If the file name pattern needs to start with white space, use a backslash
to escape the start of the file name. It is not possible to have new line
characters in the file name pattern.
Whenever an error situation is encountered, 
.B star
checks the lines in the error control file starting from the top.
If the current error condition is listed on a line in the error control file,
then
.B star
checks whether the pattern on the rest of the line matches the current file name.
If this is the case, 
.B star
uses the current error control specification to
control the current error condition.
.sp
The list of error conditions to be handled may use one or more (in this case
separated by a '|' character) identifiers from the list below:
.RS
.TP 12
.B ABORT
If this meta condition is included in an error condition,
.B star
aborts (exits) as soon as possible after this error condition has been
seen instead of making
.B star
quiet about the condition.
This error condition flag may only be used together with at least another 
error condition or a list of error conditions
(separated by a '|' character).
.TP 12
.B WARN
If this meta condition is included in an error condition,
.B star
prints the warning about the error condition but the error condition
does not affect the exit code of
.B star
and the error statistics (which is printed to the end) does not
include the related errors.
This error condition flag may only be used together with at another 
error condition or a list of error conditions
(separated by a '|' character).
The
.B WARN
meta condition has a lower precedence than
.BR ABORT .
.TP 12
.B DIFF
Suppress output in case that 
.B "star -diff"
did encounter any differences.
.TP 12
.B ALL
This is a shortcut for all error conditions below.
.TP 12
.B STAT
Suppress warnings that 
.B star 
could not 
.BR stat (2)
a file.
.TP
.B GETACL
Suppress warnings about files on which
.B star
had problems to retrieve the ACL information.
.TP
.B OPEN
Suppress warnings about files that could not be opened.
.TP
.B READ
Suppress warnings about read errors on files.
.TP
.B WRITE
Suppress warnings about write errors on files.
.TP
.B READLINK
Suppress warnings about
.BR readlink (2)
errors on symbolic links.
.TP
.B GROW
Suppress warnings about files that did grow while they have been
archived.
.TP
.B SHRINK
Suppress warnings about files that did shrink while they have been
archived.
.TP
.B MISSLINK
Suppress warnings about files for which 
.B star
was unable to archive all hard links.
.TP
.B NAMETOOLONG
Suppress warnings about files that could not be archived because the name of
the file is too long for the archive format.
.TP
.B FILETOOBIG
Suppress warnings about files that could not be archived because the size of
the file is too big for the archive format.
.TP
.B SPECIALFILE
Suppress warnings about files that could not be archived because the file type
is not supported by the archive format.
.TP
.B GETXATTR
Suppress warnings about files on that
.B star
could not retrieve the extended file attribute information.
.TP
.B CHDIR
Suppress warnings about
.BR chdir (2)
errors.
.TP
.B ICONV
Suppress warnings about
.BR iconv (3)
errors.
These error happen, when text is converted from or to POSIX.1-2001 extended tar
headers.
.TP
.B ID
Suppress warnings about
.BR uid / gid
range errors.
These errors happen when the archive format does not support the actual value.
.TP
.B SETTIME
Suppress warnings about files on that
.B star
could not set the time information during extraction.
.TP
.B SETMODE
Suppress warnings about files on that
.B star
could not set the access modes during extraction.
.TP
.B SECURITY
Suppress warnings about files that
have been skipped on extraction because they have been considered to be a
security risk.
This currently applies to all files that have a '/../' sequence inside
when
.B \-..
has not been specified.
.TP
.B LSECURITY
Suppress warnings about links that
have been skipped on extraction because they have been considered to be a 
security risk.
This currently applies to all link target names that start with '/' or
have a '/../' sequence inside when 
.B \-no\-secure\-links
has not been specified.
In this case, 
.B star 
tries to match the link name against the pattern in the error control file.
.TP
.B SAMEFILE
Suppress warnings about links that
have been skipped on extraction because source and target of the link
are pointing to the same file.
If 
.B star
would not skip these files, it would end up with removing the file completely.
In this case, 
.B star 
tries to match the link name against the pattern in the error control file.
.TP
.B BADACL
Suppress warnings about access control list conversion problems.
.TP
.B SETACL
Suppress warnings about files on that
.B star
could not set the ACL information during extraction.
.TP
.B SETXATTR
Suppress warnings about files on that
.B star
could not set the extended file attribute information during extraction.
.RE
.sp
If a specific error condition is ignored, then the error condition is not
only handled in a silent way but also excluded from the error statistics
that are printed at the end of the
.B star
run.
.sp
Be very careful when using error control as you may ignore any error condition.
If you ignore the wrong error conditions, you may not be able to see real
problems anymore.
.TP
.BI \-exclude\-from " name"
Exclude from named file, this is an alias for the
.B \-X
option. See 
.B \-X
option for more information.
.TP
.BR \-F , \-FF " ..."
Fast and simple exclude option for create mode.
With one
.B \-F
argument,
.B star
ignores all directories called
.IR SCCS " and " RCS.
With two
.B \-F
arguments,
.B star
in addition ignores all files called
.I core errs a.out
all files ending with
.IR .o  .
.IR OBJ/ .
With three
.B \-F
arguments,
.B star
ignores all sub trees starting from a directory that
includes a file
.I .mirror
or
.I .exclude
and all object files and files called
.I core errs a.out
all files ending with
.IR .o  .
With four
.B \-F
arguments,
.B star
ignores all sub trees starting from a directory that
includes a file
.I .mirror
or
.I .exclude
the latter files are excluded too as well as
and all object files and files called
.I core errs a.out
all files ending with
.IR .o  .
With five
.B \-F
arguments,
.B star
in addition again excludes 
all directories called
.IR SCCS " and " RCS.
.TP
.BI f= "tarfilename"
Use
.I tarfilename
as the name for the
.B tar
archive.
See option
.BI file= tarfilename\c
\&.
.TP
.B \-fifo
Use a 
.I fifo
to optimize data flow from/to 
.I tarfile.
This option is in effect by default (it may be changed at compile time).
The default fifo size is 8 MBytes on all platforms except Linux versions
that do not support mmap() (4 MB because kernels
before 2.4 did not handle big shared memory areas) and Sun/mc68000 (1 MB).
This will 
.B star
make even work on a tiny machine like
a Sun 3/50. The fifo size may be modified with the 
.I fs=
option. A rule of thumb for the fifo size is to use more than the buffer size
of the tape drive and less then half of the real memory of the machine.
A good choice would be to use a fifo size between 8 and 256 MB.
This may increase backup speed up to 5% compared to the speed achieved
with the default fifo size. Note that with a DLT drive from y2000 that gives 12MB/s
transfer rate, a fifo of 256 MB size will keep the tape at least streaming
in units of 20 seconds.
.sp
Future LTO tape drives are expected to implement transfer rates of aprox. 3GB/s
and need a much larger
.B fifo
size to keep the tape streaming.
.sp
All options that start with the 
.B \-f
sequence are sensitive to typo problems, see BUGS section for more information.
.TP
.B \-fifostats
Print fifo statistics at the end of a
.B star
run when the fifo has been in effect.
All options that start with the 
.B \-f
sequence are sensitive to typo problems, see BUGS section for more information.
.TP
.BI file= "tarfilename\fR, " f= "tarfilename"
Use 
.I tarfilename 
as the name for the
.B tar
archive. Currently up to 100 
.B file=
options are possible. Specifying more then one 
.B file= 
option make sense in multi volume mode. In this case 
.B star
will use the next name in the list every time a media change is needed.
To make 
.B star 
behave consistent with the single file case, 
.B star
loops over the list of known archive files.
Note that if
.B star
is installed suid root and the first tarfile is a remote archive,
only the connection to this archive will be created with root privileges.
After this connection has been established as root,
.B star
switches back to the id of the caller.
If any of the other archives in the list is located on a different host,
.B star
will not be able to open this archive later on, unless run by root.
.sp
.B Star
normally uses
.IR stdin / stdout
for the
.B tar
archive because the most common way to use 
.B star
is in conjunction with pipes.
If 
.B star
is installed suid root or if it has been called by root,
.I tarfilename
may be in remote syntax: user@host:filename as in 
.BR rcp (1)
even if 
invoked by non root users.
See SUID NOTES for more information.
.sp
To make a file local although it includes a colon (:), the filename
must start with:
.IR "'/'" ,
.IR "'./'" " or"
.I "'../'"
.sp
Note that if
.B star 
talks to an old 
.B rmt
remote tape server that does not support symbolic open modes,
it does not open a remote tape with the 
.B O_CREAT
open flag because this would be extremely dangerous.
If the 
.B rmt 
server on the other side is the 
.B rmt
server that comes with 
.B star
or the GNU
.B rmt
server,
.B star
may use the symbolic mode for the open flags.
Only the symbolic open modes allow sending all possible open
modes in a portable way to remote tape servers.
.sp
It is recommended to use the 
.B rmt
server that comes with
.BR star .
It is the only
.B rmt
server that gives platform independent compatibility with BSD, Sun and GNU
.B rmt 
clients and it includes security features that may be set up in /etc/default/rmt.
All options that start with the 
.B \-f
sequence are sensitive to typo problems, see BUGS section for more information.
.sp
See
.B \-rsh
option on how to set up a different protocol for the connection to the
remote tape server.
.sp
See ENVIRONMENT section for information on how to use 
.B ssh(1)
to create a remote tape server connection.
.sp
Note that if
.BI file= -
has been specified, it is no longer possible to use the
.B \-find
.B \-exec
primary.
.TP
.B \-find
This option acts a separator.
If it is used, all 
.B star
options must be to the left of the
.B \-find
option. To the right of the
.B \-find
option,
.B star
accepts the
.B find
command line syntax only.
.sp
The
.B find
expression acts as a filter between the source of file names and the
consumer, which may either be the archiving engine or list/extract
engine. If the
.B find
expression evaluated as TRUE, then the related file is selected for
processing, otherwise it is omited.
.sp
In order to make the evaluation of the
.B find
expression more convenient, 
.B star
implements additional
.B "find primaries"
that have side effects on the file meta data.
.B Star
implements the following additional
.B find
primaries:
.RS
.br
.ne 5
.TP
.BI \-chatime " timespec"
The primary always evaluates as true;
it modifies the
.B time of last access
of a file in
.BR "struct stat" .
See
.BR sfind (1)
for a description of
.IR timespec .
.br
.ne 5
.TP
.BI \-chctime " timespec"
The primary always evaluates as true;
it modifies the
.B time of last status change
of a file in
.BR "struct stat" .
See
.BR sfind (1)
for a description of
.IR timespec .
.br
.ne 5
.TP
.BI \-chmtime " timespec"
The primary always evaluates as true;
it modifies the
.B time of last modification
of a file in
.BR "struct stat" .
See
.BR sfind (1)
for a description of
.IR timespec .
.TP
.BI \-chgrp " gname"
The primary always evaluates as true;
it sets the group of the file to
.IR gname .
.TP
.BI \-chmod " mode"
The primary always evaluates as true;
it sets the permissions of the file to
.IR mode .
Octal and symbolic permissions are accepted for
.I mode
as with
.BR chmod (1).
.TP
.BI \-chown " uname"
The primary always evaluates as true;
it sets the owner of the file to
.IR uname .
.TP
.B \-false
The primary always evaluates as false;
it allows one to make the result of the full expression different from
the result of a part of the expression.
.TP
.B \-true
The primary always evaluates as true;
it allows one to make the result of the full expression different from
the result of a part of the expression.
.PP
The command line:
.PP
.B "star -c f=o.tar -find . ( -type d -ls -o false ) -o ! -type d"
.PP
lists all directories and archives all non-directories to the archive
.BR o.tar .
.PP
The command line:
.PP
.B "star -c f=o.tar -find . ( -type d -chown root -o true )"
.PP
archives all directories so they appear to be owned by root in the archive,
all non-directories are archived as they are in the file system.
.PP
Note that the
.BR \-ls ,
.B \-exec 
and the
.B \-ok
primary cannot be used if 
.B stdin 
or
stdout
has been redirected by the
.BI list= \-
of by the
.BI file= \-
options.
.RE
.TP
.B \-force_hole
obsoleted by \-force\-hole
.TP
.B \-force\-hole
Try to extract all files with holes. This even works with files that 
are created without the 
.B \-sparse 
option. 
.BR Star , 
in this case examines 
the content of the files in the archive and replaces writes to parts containing 
binary zeroes with seeks. 
.sp
If used together with the
.B \-sparse
option in create mode,
.B star
assumes all files to be sparse and archives files with blocks of nulls as sparse files.
.sp
This option should be used with extreme care 
because you sometimes get in trouble when files get unattended holes.
All options that start with the 
.B \-f
sequence are sensitive to typo problems, see BUGS section for more information.
.TP
.B \-force_remove
obsoleted by \-force\-remove
.TP
.B \-force\-remove
Force to remove non writable files on extraction.
By default, 
.B star
will not overwrite files that are read only.
If this option is in effect, 
.B star
will silently remove these files to allow the extraction of a file.
All options that start with the 
.B \-f
sequence are sensitive to typo problems, see BUGS section for more information.
.TP
.B \-force\-restore
Force an incremental restore even if there is a dump level mismatch or
a reference date mismatch.
See
.BR \-wtardumps ,
.B level=
and sections
.B "INCREMENTAL BACKUPS"
and
.B "INCREMENTAL RESTORES"
for more information.
.TP
.B \-freeze
Run the input or output through a
.B freeze
pipe.
See section
.B COMPRESSION
for details.
.TP
.BI fs= #
Set fifo size to #.
See 
.I bs=
for the possible syntax.
.sp
The default size of the fifo is 1 Mbyte on Sun mc68000 systems,
4 Mbytes on non mmap() aware Linux systems and 8 Mbytes on all other systems.
See
.B \-fifo
option for hints on using the right fifo size.

.TP
.BI fs-name= mount_point
Use
.I mount_point
when recording information in
.B /etc/tardumps
and when comparing against information in
.B /etc/tardumps
for incremental backups.
This makes sense when backups are made using file system snapshots
and allows 
.B /etc/tardumps
and the archive to contain the real name of the file system instead of the
temporary mount point that is used for the snapshot device.

.TP
.BI H= headertype
See
.BI artype= headertype
option.
Note that POSIX.1-2001 defines an option
.B \-H
that follows symbolic links that have been encountered on the command line.
For this reason, the old star option
.BI H= headertype
option may go away in the future even though this option has been in use by
cpio since 1989.
.TP
.B \-h, \-L
Follow symbolic links as if they were files.
Normally 
.B star
will not follow symbolic links but stores their values in
.I tarfile.
See also the
.B \-L
option.
.TP
.B \-hardlinks
In extract mode, this option tells
.B star
to try to create a hardlink whenever a symlink is encountered in the archive.
In create mode, this option tells
.B star
to try to archive a hardlink whenever a symlink is encountered in the
file system.
.TP
.B \-hpdev
Allow 24 bits for the minor device number using 8 octal digits.
Note that although it allows one to create
.B tar
archives
that can be read with HP\-UX tar, this creates
.B tar
archives
which violate POSIX.1\-1988.
This option is only needed if you like to use a POSIX.1\-1988 based archive
format that does not include extensions.
If you use the
.B xstar
format, 
.B star
will use a base 256 extension that allows bigger major/minor numbers by default,
if you use the
.B xustar 
or the
.B exustar
format there is no limitation at all as these formats use POSIX.1\-2001
extended headers to archive the major/minor numbers by default.
.TP
.B \-i
Ignore checksum errors on
.B tar
headers.
If this option is specified,
.B star
will not exit if a header with a bad checksum is found but search for the
next valid header.
.TP
.B \-install
Carefully replace existing files when extracting files. This is done
similar to
.BR install "(1)"
by first extracting the files into a temporary name and renaming
the file to the final name after the extraction of that file was
successful.
.sp
As
.B star
by default does not remove non-empty directories, an install that needs
to remove existing non-empty directories may also need the options
.B \-force\-remove
and
.BR \-remove\-recursive .
.TP
.BI iskip= #
Set the initial skip size to #.
See 
.I bs=
for the possible syntax.
.sp
The skip size is the number of bytes to ignore from the first
tape record. This option is typically used if a tar archive on a
tape is not read from the beginning and the tape has been forwarded
before the tape is read.
.B iskip=
then specifies the offset of the first archive header within the
current tape record. It does not work on compressed archives.
.TP
.B \-j
Run the input or output through a 
.B bzip2
pipe.
This option is an alias for
.BR \-bz .
See section
.B COMPRESSION for details.
.TP
.B \-keep\-nonempty\-dirs
Do not complain about trying to remove nonempty directories in case that
.B \-remove\-recursive
has not been specified.
.TP
.B \-keep_old_files
obsoleted by \-keep\-old\-files
.TP
.BR \-keep\-old\-files ", " \-k
Keep existing files rather than restoring them from 
.I tarfile. 
This saves files from being clobbered even if 
.I tarfile
contains a more recent version of the corresponding file.
.sp
See
.B SECURITY NOTES
for more information.
.TP
.B \-L, \-h
Follow symbolic links as if they were files.
Normally 
.B star
will not follow symbolic links but stores their values in
.I tarfile.
See also the
.B \-h
option.
.TP
.B \-l
Do not print a warning message if not all links to hard linked files
could be dumped. This option is evaluated in the opposite way to historic
.BR tar (1)
implementations and to POSIX.1.
POSIX.1 requests that by default no warning messages will be printed
and
.B \-l
will enable warning messages when not all links could be archived.
.TP
.BI level= dumplevel
Set level for incremental dumps.
This option is used to switch 
.B star
into
.I "true incremental dump"
mode.
The 
.I dumplevel
may be in the range between 0..99.
.sp
In 
.I "true incremental dump"
mode, a
.B \-C
option which is followed by the name a mount point and a dot ('.') as
starting directory name is required. 
Only a single file system may be handled at a time.
If the directory following the
.B \-C
option is not referring to a root directory of a file system, the dump
is called a
.BR "partial dump" .
If the directory following the
.B \-C
option is referring to a root directory of a file system
and no other restrictions apply that exclude certain files
from the dump, the dump is called a
.BR "full dump" .
.sp
By default, the
.B tardumps
database is not written.
See also the
.BI tardumps= name
and
.B \-wtardumps
options and the section
.B "INCREMENTAL BACKUPS"
for more information.
.TP
.B \-link\-data
In create mode, include the data for files even if these files are
hard links. This feature in create mode is currently only available
for the
.B exustar
archive format and only in case
.B \-sparse
has not been specified.
.sp
In extract mode, allow
.B star
to deal with data in hard linked files even if the standard would not 
allow this for the used archive format.
.TP
.B \-link\-dirs
When in create mode, try to find hard linked directories.
Using
.B \-link\-dirs
will force 
.B star
to keep track of all directories that will go into the archive and thus
causes a lot more memory to be allocated than in the default case.
.sp
If you like to extract a
.B cpio
archive that contains hard linked directories, you also need to specify
.B \-link\-dirs
in extract or diff mode.
This is needed because many
.B cpio
implementations create buggy archives with respect to hard links.
If 
.B star
would look for hard linked directories in all cases, it would
detect many pseudo hard links to directories.
Use
.B \-link\-dirs
with care if you extract 
.B cpio
archives.
.sp
Note that not all filesystem allow creating hard links to directories.
Also note that even though a non-root user is able detect and archive
hard linked directories, all known operating systems require the extraction
to be done as root in order to be able to create or remove hard links to directories.
For this reason its only recommended to use this option when doing accurate
backups and when hard links to directories are expected.
.sp
When the option
.B \-link\-dirs
is not used and hard links to directories are present, the appendant sub-tree
will appear more than once on the archive and
.B star
will print 
.I "Linkcount below zero"
warnings for non directory hard links inside the sub-tree.
.TP
.BI list= filename
Read filenames for store/create/list/diff command from
.I filename.
The file
.I filename
must contain a list of path names, each on a separate line.
This option implies the 
.B \-D 
option.
To force
.B star
to descend directories, use the
.B \-dodesc
option in this case.
See also the 
.B \-X
option.
.sp
If used together with
.BR \-find ,
no
.I path list
is accepted after the option
.BR \-find .
.sp
See also the option
.B pkglist=
for a way to specify
.BR filename ,
.BR permission ,
.B owner
and
.BR group .
.sp
Note that if
.BI list= -
has been specified, it is no longer possible to use the
.B \-find
.B \-exec
primary.
.TP
.B \-lowmem
Try to run with reduced memory requirements.
This causes
.B star
to default to 1 MB of FIFO memory.
Instead of allocating memory to hold the directory content and reading the
directory at once,
.B star
reads the directory name by name. This may cause
.B star
to close the directory if it runs out of file descriptors because of deeply
nested directories. If a directory then does not support
.BR telldir(3)/seekdir(3) ,
.B star
will fail.
.br
.ne 5
.TP
.B \-lzip
Run the input or output through a
.B lzip
pipe.
See section
.B COMPRESSION
for details.
.TP
.B \-lzma
Run the input or output through a
.B lzma
pipe.
See section
.B COMPRESSION
for details.
.TP
.B \-lzo
Run the input or output through a
.B lzop
pipe.
See section
.B COMPRESSION
for details.
.TP
.BR \-M ", " \-xdev
Do not descend mount points.
This is useful when doing backups of complete file systems. 
See NOTES for more information.
.sp
When using
.BR \-find ,
this may not always work as expected, e.g. when the
.B /proc
filesystem is involved.
Use
.B \-xdev
past
.B \-find
for this reason.
.TP
.B \-m
Do not restore access and modification time. 
(Access time is only available if 
.B star
is reading 
.BR star ,
.BR xstar ,
.BR xustar ,
.BR exustar ,
or
.BR pax / epax
archives). If 
.B star
extracts other archive types, the 
.B \-m
flag only refers to the modification time.

.TP
.B \-match\-tree
If in create mode a pattern does not match a directory, and 
.B \-match\-tree
has been specified, the whole directory tree is excluded from
the archive and from further directory scans.
By default, 
.B star
excludes the directory but still recursively scans the content of this
directory as complex patterns could allow files inside the directory tree
to match.
Using
.B \-match\-tree
allows one to efficiently exclude whole trees from scanning. This helps to
avoid scanning directory trees that are on remote file systems or contain
excessive bad blocks.
.TP
.BI maxsize= #
Do not store files in
.I tarfile
if they are bigger than #.
See 
.I bs=
for the possible syntax.
By default, the number is multiplied by
1024, so the value counts in units of kBytes.
If the size specifier ends with a valid multiplication character
(e.g '.' for bytes or 'M' for MB) the specified size is used as specified
and not multiplied by 1024.
See
.B bs=
option for all possible multipliers.
.TP
.B \-meta
In create mode,
.B \-meta
causes
.B star
to archive all 
.B meta
data of the file (e.g. uid, permissions, ...) but not the
file content. In extract mode, it causes 
.B star
to restore all 
.B meta
data but not the file content. In addition, in extract mode
no plain file, special file or directory will be created.
.B Meta
files are needed to support incremental backups.
.sp
Warning: Do not try to extract
.B star
archives containing
.B meta
files using other tar implementations if they are not aware of the
.B meta
file extensions of 
.BR star .
.B Star
tries to force all tar implementations that are not standard compliant to abort.
.B Star 
also tries to make all non POSIX.1-2001 compliant tar implementations unable
to find a valid filename. However when other POSIX.1-2001 aware tar implementations
come up and don't know about
.B meta
files, they will destroy files on disk.
.sp
The problems result from the only current fallback in the POSIX standard that 
tells tar implementations to treat all unknown file types as if they were 
plain files. As 
.B meta
files are needed for incremental backups, I am looking for people and companies 
who like to support me to be able to add the 
.B meta
file concept to the POSIX.1-2005 standard.
.TP
.B \-modebits
This options allows you to create
.B tar
archives that include
more than 12 bits from st_mode. Note this create
.B tar
archives
that violate POSIX but some
.B tar
implementations insist in reading
such nonstandard archives.
.TP
.BI mtskip= #
Set the initial archive skip amount to #.
See 
.I bs=
for the possible syntax.
.sp
The archive skip size is the number of 512 byte blocks to ignore
before starting to read the archive. Typically, the value printed
by the
.B \-block\-number
option is used as the parameter.
.sp
This option is used if a tar archive on a
tape is not read from the beginning in order to fast forward to 
a specific file. Check the
.B \-one\-file
option for a way to extract only one file from the archive.
.sp
If the archive is a plain file, this option results in a
.BR lseek ()
call to the input file.
If the archive is a magnetic tape, this option results in a
.BR mtioctl ( MTFSR )
call for the part of the blocks that can be represented by the tape block size
followed by a skip of the remainder of the blocks. Since
.B star
learns about the tape block size from the first
.BR read ()
call, this option does not work correctly if the tape block size used by
.B star
does not match the tape block size on the medium. See the
.BI blocks= #
option above for information on the tape block size.
.sp
If
.BI mtskip= #
has been specified, a 
.BI iskip= #
option is ignored and the value is rather computed from the
.BI mtskip= #
parameter.
.BI mtskip= #
does not work on compressed archives.
.TP
.B \-multivol
Switch to multi volume mode.
In multi volume mode, there will be no logical EOF marker written to the end
of a single tape. If
.B \-multivol
is used in read mode, a hard EOF on input (if not preceded by a logical EOF)
triggers a medium change operation.
.sp
Specifying
.B \-multivol
tells
.B star
to split files across volumes if needed.
This way, a virtual archive is created that spans more than one medium.
Multi volume mode is needed whenever it is not possible to split the
archiving or extracting into several logically independent tasks. This is
true for e.g. incremental dump/restore operations where inode numbers need
to be traced for the whole task.
.sp
When
.BI tsize= #
has been specified, but
.B star 
is not in multi volume mode, files cannot be split across volumes.
.sp
When
.B \-multivol
has been specified in create mode together with
.BI tsize= #
then a media change is initiated exactly after an amount of
.I tsize
data has been written.
When
.B \-multivol
has been specified in create mode and
.BI tsize= #
has not been specified, then the medium change is triggered by a EOT condition
from writing the medium. This allows one to use media where the size cannot be known
in advance (e.g. tapes with build in compression); it does not work if the
EOT condition is not returned in sync with the related write operation. For this
reason, it is expected that data buffering inside a device driver cannot be used.
.sp
Depending on the selected archive format,
.B star
writes a volume header at the beginning of a new medium. This medium header
allows one to verify the correct volume after a change during read back.
It is recommended to use the
.B exustar
format for best results.
In create mode,
.B \-multivol
is only supported for archives types that allow writing reliable multi volume
header information.
.sp
See
.BI tsize= #
option for more information.
.sp
Note that
.B \-multivol
is an interactive option that prevents
.B star
from being used in non-interactive environments.
If you like to use it in a non-interactive environment, you need to
specify
.BI new\-volume\-script= script
in addition in order to automate the media change procedure.
.TP
.BI newer= filename
Do not store files to 
.I tarfile
if their modification time is not newer than the modification time of
.I filename.
See 
.B \-ctime
option for changing this behavior.
.TP
.B \-newest
In conjunction with the list command this lists you only the newest file in
.I tarfile.
.TP
.B \-newest_file
obsoleted by \-newest\-file
.TP
.B \-newest\-file
In conjunction with the list command this lists you only the newest regular 
file in
.I tarfile.
.TP
.BI new\-volume\-script= script
Call 
.I script
at end of each tape (even the last one) if in multi volume mode or if the
.B tsize=
option has been specified.
If this option is not in effect, 
.B star
will ask the user to confirm the volume change.
The script is called with two parameters.
The first parameter is the next volume number and the second
parameter is the next archive file name.
.TP
.B \-nodump
If this option is set, 
.B star
will not dump files that have the
.B nodump
flag set. Note that this currently only works on BSD\-4.4 derivates
and on Linux.
On Linux, using this option will cause a performance degradation
(the system time increases by 10%) because of the unlucky kernel interface
that requires a separate open and ioctl.
.TP
.B \-no-dirslash
Do not add a slash to the end of directory names if writing to an archive.
Historic tar archive formats did only allow specifying plain files and hard links.
Around 1980, BSD added a feature to specify a directory on tape by adding
a slash to the end of the name. POSIX.1-1988 defined the first official tar
archive format that had a clean method to specify the type of a directory.
As old tar formats need the slash to recognize a directory,
.B \-no-dirslash
may not be used if archives should be compatible with the old tar format.
.TP
.B \-no_fifo
obsoleted by \-no\-fifo
.TP
.B \-no\-fifo
Don't use a
.I fifo
to optimize data flow from/to 
.I tarfile.
Currently the 
.I \-fifo 
option is used as default. (This may be changed at compile time.)
.TP
.B \-no\-fsync
Do not call
.B fsync(2)
for each file that has been extracted from the archive. 
Using
.B \-no\-fsync
may speed up extraction on operating systems
with slow file I/O (such as Linux with any filesystem or
platforms with Copy on Write filesystems like ZFS),
but includes the risk that
.B star
may not be able to detect extraction problems that occur after the call
to
.BR close (2).
A typical cause for such problems is a NFS file system that
fills up before the buffer cache is synced or
a write error that occurs while the buffer cache is synced.
There may be other reasons.
Use with extreme care.
.sp
See also
.B \-do\-fsync
and
.B STAR_FSYNC
in
.B ENVIRONMENT
and
.B /etc/default/star
for ways to configure the default behavior.
.TP
.BR \-nochown ", " \-o
Do not restore owner and group of files. 
This may be used if super user privileges are needed to overwrite 
existing files but the local ownership of the existing files should 
not change.
.TP
.B \-no\-p
Do not restore files and directories to their original permissions.
This option is needed only if
.B star
is called by the super user and the permissions should not be restored
from the archive.
See also the
.B \-p
option. The
.B \-p
options has a higher precedence than the
.B \-no\-p
option.
.TP
.B \-no_statistics
obsoleted by \-no\-statistics
.TP
.B \-no\-statistics
Do not print statistic messages at the end of a
.B star
run.
.TP
.B \-no\-secure\-links
Extract hard links or symbolic links even if the target of the link
starts with a slash (/) or if /../ is contained in the link target.
See the description of the option
.B \-secure\-links
below and
.B STAR_SECURE_LINKS
in
.B ENVIRONMENT
and
.B /etc/default/star
for ways to configure the default behavior.
.TP
.B \-no\-xheader
Do not create or extract POSIX.1-2001 extended headers.
This option may be used if you like to read an archive with broken
extended headers.
.TP
.BR \-not ", " \-V
Invert the meaning of the pattern list. i.e. use those files which do not match
any of the pattern.
Note that this option only applies to patterns that have been specified
via the
.BR pattern= "pattern or " pat= pattern
option. Patterns specified as file type arguments will not be affected.
.TP
.BR \-notarg ", " \-pax-c
Match all file or archive members except those specified by the pattern or file operands.
.TP
.B \-nowarn
Do not print warning messages.
This sometimes is useful to make the output more readable
(e.g. when hundreds of files that are going to be extracted are not newer
in the archive then on the filesystem).
.TP
.B \-numeric
Use the numeric user/group fields in the listing rather than the 
default.
The default allows one to list the ASCII version of user/group of the file
and to extract the owners of the files based on numeric values rather
than the names.
In create mode, no user/groups names are put on the archive.
The
.B \-numeric
option also applies when ACLs are going to be archived or extracted.
.TP
.B \-O
Be compatible to old versions of
.BR tar .
If 
.B star 
is invoked with this option, 
.B star 
generates archives which are 
fully compatible with old UNIX
.B tar
archives. If in extract mode, 
.B star 
ignores any additional info in the headers.
This implies neither that archives generated with this option are 
binary equal with archives generated by old
.B tar
versions nor that 
.B star 
is trying to comprehend all bugs that are found in old
.B tar
versions.
The bug in old
.B tar
versions that cause a reversal of a space and a NULL byte 
in the checksum field is not repeated. 
If you want to have signed checksums you have to specify the
.I \-signed\-checksum
option too. 
If you want directories not to be archived in order to be compatible
to very old historic tar archives, you need to specify the
.I \-d
option too. 
.sp
This option is superseded by the 
.BR H= headertype 
option.
.TP
.BR \-o ", " \-nochown
Do not restore owner and group of files. 
This may be used if super user privileges are needed to overwrite 
existing files but the local ownership of the existing files should 
not change.
.TP
.B \-one-file
Exit
.B star
after one file has been extracted as a result from a match with
a pattern or with a command line argument.
This option is intended for users that need to restore single files
from larger tape archives and do not like to wait until the end of
the tape is reached.
To let
.B star
exit after the first file, call
.B \-one-file
together with
.BR pat=* .
This is e.g. useful together with the option
.BI mtskip= #\c
\&.
.TP
.BR \-onull ", " \-nullout
Do not actually write to the archive but compute and add the sizes.
This is useful when trying to figure out if a tape may hold
the current backup.
Please only use the
.B \-onull
option as it is a similar option as used by the
.BR sdd (1)
command.
.TP
.B \-P
Allow 
.B star
to write a partial record as the last record. 
Normally, 
.B star 
writes each record with the same size.
This option is useful on unblocked tapes i.e. cartridge tapes like QIC tapes
as well as with archives that are located in files.
If you use this option on local files, the size of the archive will be smaller.
If you use this option on cartridge tapes, is makes sure that later - in extract mode -
.B star
will read up to the end of file marker on the tape and the next call to
.B star
will read from the next archive on the same tape.
.TP
.B \-p
Restore files and directories to their original permissions.
Without this option, they are created using the permissions in the archive
and the present 
.BR umask (2).
If
.B star
is called by the super user,
.B star
behaves as if it has been called with the
.B \-p
option. See also 
.B \-no\-p
option.
If the archive contains Access Control Lists (ACLs) in
POSIX.1\-2001 extended headers,
.B star
will restore the access control lists from the archive for files
if the \-acl option is specified.
If the option \-acl has not been specified, ACLs are not restored at all.
.TP
.B \-partial
Force an incremental restore even if the incremental dump is only a partial
dump. See
.BR \-wtardumps ,
.B level=
and sections
.B "INCREMENTAL BACKUPS"
and
.B "INCREMENTAL RESTORES"
for more information.
.TP
.BI pattern= "pattern\fR, " pat= pattern
Set matching pattern to
.I pattern.
A maximum of 100 pattern=pat options may be specified. 
As each pattern is unlimited in length, this is no real limitation.
If more than one pattern is specified, a file matches if any of the 
specified pattern matches.
Patterns may be used in create mode to select or exclude files
from the list of file type arguments or the files located in a sub tree
of a file type argument directory.
By default,
.B star
scans the whole directory tree underneath a directory that is in the argument
list. This may be modified by using the
.B \-match\-tree
option.
In extract or list mode, all file type arguments are interpreted to be
select pattern and all option type patterns may be either select or exclude patterns
depending on the presence or absence of the
.B \-not
option.
If you use file type select patterns, they work exactly like the method
used by other (non pattern aware) 
.BR tar (1)
implementations.
File type select patterns do not offer pattern matching but allow restoring subtrees.
To extract a complete sub tree 
from the directory
.I dir
with 
.B star
using the 
.B pattern=
option, use
.B pattern=
.I "dir/\\\\*"
if you like to select a subtree by using the historic method, use
.I "dir"
as file type argument.
If you only like to extract the directory itself, use
.I "dir/"
as file type argument.
See manual page for 
.BR match (1)
for more details of the pattern matcher.
All patterns are selection patterns by default. To make them exclude patterns,
use the 
.B \-not
or the
.B \-V 
option.
.TP
.BI pkglist= file
This is (for now) an internal interface for the Schily Source Package System (sps).
It only works in create mode and behaves similar to the
.B list=
option, but it allows one to overwrite the
.BR permissions ,
the 
.B uid
and
.B gid
values from the content of the 
.B pkglist=
file.
Each line from the
.B pkglist=
file contains a file name followed by the permission, a user name and a group name.
The permission is an octal character string.
Each value that is not used to overwrite the original values may be replaced by a '?'.
The fields are separated by spaces, so the
.B pkglist=
option does not allow files that contain newline or space characters.
.sp
If used together with 
.BR \-find ,
the
.IR uid ,
.IR gid
and
.I permission
values from the
.BI pkglist= file
have precedence over changes on this meta data introduced by
.BR libfind .
.sp
See
.B list= 
option for further information.
.TP
.BR \-pax\-c ", " \-notarg
Match all file or archive members except those specified by the pattern or file operands.
.TP
.B \-pax\-H
Follow symbolic links that have been encountered on the command line.
If the referenced file does not exist, the file information and type will be for the link itself.
If the link is referencing a file type that cannot be archived with the current archive format,
the file information and type will be for the link itself.
.TP
.B \-pax\-i
Do interactive renaming in a way that has been defined for POSIX
.BR pax .
.B Star
will print the original filename and prompt for a reply.
If you type just 
.BR RETURN ,
than the file is skipped.
If you type '.', then the original file name is retained.
If you type anything else, then this is taken as the new file name.
.sp
Note that
.B \-pax\-i
is an interactive option that prevents
.B star
from being used in non-interactive environments.
.TP
.B \-pax\-L
Follow symbolic links.
If the referenced file does not exist, the file information and type will be for the link itself.
If the link is referencing a file type that cannot be archived with the current archive format,
the file information and type will be for the link itself.
.TP
.B \-pax\-ls
Switch listing format to the format defined for POSIX 
.B pax
and
.BR ls .
.TP
.B \-pax-match
Allow file type arguments to be recognised as regular expressions in a way that has been defined
for POSIX
.BR pax .
.TP
.B \-pax\-n
Allow each pattern to match only once.
If a pattern matches a directory, then the whole sub tree matches the pattern.
.TP
.BI \-pax\-o " string"
Set a
.B pax
like option control pattern.
.sp
The only argument that is currently supported is
.B binary
to create a
.B hdrcharset=BINARY
header.
.TP
.BI \-pax\-p " string"
PAX style privileges string.
Several characters (each has its own meaning). The following characters are defined:
.RS
.TP
.B a
Do not preserve file access times.
This option is currently ignored.
.TP
.B e
Preserve the user ID, group ID, file mode bits.
This is equivalent to calling
.BR "star \-p \-acl \-xfflags" "."
.TP
.B m
Do not preserve file modification times.
This is currently equivalent to calling
.BR "star \-m" "."
.TP
.B o
Preserve the user ID and group ID.
This is the default for
.B star
if called as root.
.TP
.B p
Preserve the file mode bits.
This is equivalent to calling
.BR "star \-p" "."
.RE

.TP
.BI \-pax\-s " replstr"
Modify file or archive member names named by a pattern according to the
substitution expression
.IR replstr .
The format of 
.I replstr
is:
.sp
.BI "	\-pax\-s\ " /old/new/[gp]
.sp
The
.B old
pattern may use regular expressions and the 
.B new
string may contain the special character '&'. The character '&' is substituted by the
string that matches the
.B old
pattern.
The
.B new
string may also contain the special strings '\e1' .. '\e9' that refer to parts of the
.B old
string selected by '\e(...\e)' groups.
The optional trailing 'g' means global substitution. If 'g' is not used, a substitution
pattern is only used once on a name.
If the optional trailing 'p' is used, the substitution is printed to standard error.
.sp
Up to 100 substitute options may be used. If more than one substitute option has been
specified,
.B star
will loop over all substitute patterns until one matches.
The up to 100 substitute options are processed together with the
.BI \-s " replstr"
options in the order they appear on the command line.
.sp
If the name substitutes to the empty string, the file is skipped.
.sp
If the target platform for
.B star
does not support
.B regex
functions, there is a silent fallback to the
.BI \-s " replstr"
option and the '\e1' .. '\e9' substitutions are not possible.
.TP
.B \-prinodes
Print inode numbers in verbose list mode if the archive contains
inode numbers.
.TP
.B \-print\-artype
Check the type of the archive, print the archive and compression type on a single
line and exit.
.TP
.B \-qic24
Set tape volume size to 61440 kBytes.
See
.BI tsize= #
option for more information.
.TP
.B \-qic120
Set tape volume size to 128000 kBytes.
See
.BI tsize= #
option for more information.
.TP
.B \-qic150
Set tape volume size to 153600 kBytes.
See
.BI tsize= #
option for more information.
.TP
.B \-qic250
Set tape volume size to 256000 kBytes.
See
.BI tsize= #
option for more information.
.TP
.B \-qic525
Set tape volume size to 512500 kBytes.
See
.BI tsize= #
option for more information.
.TP
.B \-read0
Read null terminated file names from the file specified with the 
.B list=
option.
.TP
.B \-refresh_old_files
obsoleted by \-refresh\-old\-files
.TP
.B \-refresh\-old\-files
.TP
.B \-refresh
Do not create new files. Only already existing files may be overwritten from
.I tarfile 
if either newer versions are present in the archive or if the 
.B \-U
flag is used. 
This allows one to overwrite files by more recent files from an archive
that contains more files than the target directory should contain.
The option
.B \-refresh\-old\-files
is the same as the 
.B \-refresh
option.
.TP
.B \-remove_first
obsoleted by \-remove\-first
.TP
.B \-remove\-first
Remove files before extraction.
If this option is in effect, 
.B star
will remove files before extracting a file from the archive.
This is needed if you want to change the file type or if you need
to break a hard link.
If you do not use either
.B \-ask\-remove
or
.B \-force\-remove
together with 
.BR \-remove\-first , 
this option is useless and no files will be removed.
.TP
.B \-remove_recursive
obsoleted by \-remove\-recursive
.TP
.B \-remove\-recursive
Remove files recursive.
If removing of a file is permitted, 
.B star
will only remove files, specials and empty directories.
If this option is in effect,
.B star
will be allowed to recursively removes non empty directories too.
.TP
.B \-restore
switches
.B star
into
.I "true incremental restore"
mode.
A file named
.B star-symtable
and a directory named
.B star-tmpdir
is created in the root directory of the file system where the extraction
takes place.
If
.B \-restore
has been specified, star behaves as if
.B \-xdot
has been specified too.
See also
.B level=
option 
and section
.B "INCREMENTAL BACKUPS"
for more information.
.sp
Note: Do not use the
.B \-restore
option if you only like to restore a single file or a list of selected files.
.TP
.BI rmt= path
Specify the path to the program at the remote tape server for the
.B RMT
protocol.
.sp
.B star
by default calls the UNIX default path
.BR /etc/rmt .
.sp
Since most
.B rmt
implementations cause problems in case that server and client are on a different
OS, it is recommended to tell
.B star
to call the
.B rmt
program that comes with
star
.RB ( /opt/schily/sbin/rmt ).
.TP
.BI rsh= path
Specify the program to log into the remote tape server for the
.B RMT
protocol.
If the argument is the empty string, connections are made via
.BR rcmd (3).
The default method to log into the remote server is configurable at compile
time. The current default is set up to use
.BR ssh .
.TP
.B \-S
Do not store/create special files.
A special files is any file except plain files, symbolic links and directories.
You need to be super user to extract special files.
.TP
.BI \-s " replstr"
Modify file or archive member names named by a pattern according to the
substitution expression
.IR replstr .
The format of 
.I replstr
is:
.sp
.BI "	\-s\ " /old/new/[gp]
.sp
The
.B old
pattern may use regular expressions and the 
.B new
string may contain the special character '&'. The character '&' is substituted by the
string that matches the
.B old
pattern.
The optional trailing 'g' means global substitution. If 'g' is not used, a substitution
pattern is only used once on a name.
If the optional trailing 'p' is used, the substitution is printed to standard error.
.sp
Up to 100 substitute options may be used. If more than one substitute option has been
specified,
.B star
will loop over all substitute patterns until one matches.
The up to 100 substitute options are processed together with the
.BI \-pax\-s " replstr"
options in the order they appear on the command line.
.sp
If the name substitutes to the empty string, the file is skipped.
.TP
.B \-secure\-links
Do not extract hard links or symbolic links if the target of the link
starts with a slash
.RB ( / )
or if
.B /../
is contained in the link target.
Tar archives containing such links could be used to compromise the system. If they are
unpacked together with a lot of other files, this may not even be noticed.
.sp
Links that do not point outside the tree that starts with the current
working directory are not seen as a security risk. This makes
.B star
easy to use.
It is always safe to unpack an unknown archive in an empty directory.
.sp
Many system installations contain plenty of symbolic links with absolute
path name or with
.B /../
inside.
The usability of a tar archiver for system backups and in copy mode
would be limited if
.B \-secure\-links
checking would be done by default for backups or when in copy mode,
.B star
thus makes link checking optional when in
.B \-restore
or in
.B \-copy
mode.
When neither
.B \-restore
nor
.B \-copy
have been specified, link checking is the default, since this is the usual
way when archives from unknown sources are going to be unpacked.
.sp
To turn off
this default for the usual case, the option
.B \-no\-secure\-links
may be used and in
.B \-restore
or
.B \-copy
mode, 
.B \-secure\-links
may be specified to turn it on.
.sp
If you unpacked a tar archive while
.B \-secure\-links
is effective and did not get a security warning at the end of the 
.B star
run, all files and links have been extracted.
If you get a warning, you should unpack the archive a second time and specify the
options
.BR \-k ", " \-w " and " \-nowarn
in addition to the options used for the first run.
To speed this up, it helps to use:
.sp
.B "    star -xvpw -find -type l"
.sp
See section
.B SECURITY NOTES
for more information and
.B STAR_SECURE_LINKS
in
.B ENVIRONMENT
and
.B /etc/default/star
for ways to configure the default behavior.
.TP
.B \-shm
Use System V shared memory for fifo. 
Normally 
.B star
is compiled to use mapped /dev/zero pages for the fifo, if the operating system 
supports this.
If 
.B star
is compiled to have both code for mapped pages and for System V shared memory,
.B star
will use shared memory instead of the default.
If the 
.I \-help
menu doesn't show the 
.I \-shm 
flag you have no choice.
When using System V shared memory, you may have to raise the system's internal
limit for shared memory resources to get enough shared memory for 
.BR star . 
.TP
.B \-signed_checksum
obsoleted by \-signed\-checksum
.TP
.B \-signed\-checksum
Use signed chars to calculate checksums. This violates the
.B tar
specs but old 
versions of 
.B tar 
derived from the seventh edition of UNIX are implemented in this way.
Note: Only filenames and linknames containing chars with the most 
significant bit set may trigger this problem because all 
other fields only contain 7 bit ASCII characters, octal digits or binary 
zeroes.
.TP
.B \-silent
Suppress informational messages like
.IR "foobar is sparse" .
.TP
.B \-sparse
Handle files with holes effectively on store/create.
Note that sparse files may not be archived this way if the archive format is
.BR tar ,
.BR ustar ,
.BR suntar ,
.BR pax ,
or any
.B cpio
variant.
On Solaris-2.3 ... Solaris-2.5.1 there is a special ioctl() called 
.I _FIOAI
that allows root to get the allocation info more efficiently.
On Solaris 11 there is an enhanced
.BR lseek (2)
call with additional whence values
.B SEEK_HOLE
and
.B SEEK_DATA
that allow finding holes in an efficient way.
Other operating systems lack support to get the real allocation list
and force 
.B star
to scan the files to look for blocks that only contain null characters.
This may 
.B star
cause to assume more holes to be present than the number that the file really contains.
.TP
.B \-symlinks
This option tells
.B star
in extract mode to try to create a symlink whenever a hardlink is encountered
in the archive.
.TP
.B \-T
If the option 
.B file= 
or 
.B f= 
is omitted and the \-T option is present, 
.B star
will use the device indicated by the 
.SB TAPE 
environment variable, 
if set.
.TP
.BI tardumps= name
Set the file name for tar dump dates database to
.BR name .
The default name is 
.BR /etc/tardumps .
Use in combination with the
.B level= 
option to create
.IR "true incremental dumps" .
See also 
.B \-wtardumps
option and section
.B "INCREMENTAL BACKUPS"
for more information.
.TP
.B \-time
Print timing info.
See DIAGNOSTICS for more information.
.TP
.B \-to_stdout
obsoleted by \-to\-stdout
.TP
.B \-to\-stdout
Extract files to stdout. This option may be used to extract
.I tarfiles
containing
.I tarfiles
(see examples below).
.TP
.B \-tpath
Use this option together with the 
.I \-t
option or with 
.I \-cv
(verbose create) to get only a list of the 
pathnames of the files in the archive.
This may be used in shell scripts to generate a name list.
If used together with the 
.I \-diff 
option, 
.B star
will only print the names of the files that differ.
A second run of
.B star 
may then be used to restore all files that had differences to the archive.
Use the
.I list=
option to specify the namelist in this case.
.TP
.BR tsize= #
Set tape volume size to # to enable multi volume tape support.
The value refers to the archive size without compression.
See 
.I bs=
for the possible syntax.
By default, the number is multiplied by
512, so the value counts in units of 512 byte blocks.
If the size specifier ends with a valid multiplication character
(e.g '.' for bytes or 'M' for MB) the specified size is used as specified
and not multiplied by 512.
With this option in effect, 
.B star 
is able to archive filesystems that are bigger then the tape size.
If the option
.BR tsize= #
without
.B \-multivol
then no file will be split across volumes and each volume may in theory
be read back separately.
Files that do not fit on a single tape may not be stored in this mode.
If
.B \-multivol
has been specified in addition,
.B star
will split files when the maximum allowed tape size has been reached.
If the tape volume size is not a multiple of the tape block size,
the tape volume size is silently rounded down to a value that is a 
multiple of the tape block size.
.sp
See
.B \-multivol
option for more information.
.TP
.B \-U
Restore files unconditionally.
By default, an older file from the archive will not replace a corresponding newer file on 
disk.
.TP
.BI umask= mask
Set
.B star's
umask to
.IR mask .
This allows one to control the permissions for intermediate directories that
are created by
.B star
in extract mode.
See also
.B \-p
option.
.TP
.B \-uncond\-rename
When in interactive restore mode or when the
.B \-s
option was specified, unconditionally ask for a new name or apply a substitution.
This happens even when the current path name would be skipped otherwise
because the file in the archive is not
newer than the file with the original name on disk.
.TP
.B \-v
Increment verbose level by one.
This normally results in more output during operation.
See also in the description for the
.I \-t
flag.
Normally, 
.B star
does its work silently.
If the verbose level is 2 or more and
.B star
is in create or update mode, 
.B star
will produce a listing to the format of the ls \-l output.
.TP
.BR \-V ", " \-not
Invert the meaning of the pattern list. i.e. use those files which do not match
any of the pattern.
Note that this option only applies to patterns that have been specified
via the
.BR pattern= "pattern or " pat= pattern
option. Patterns specified as file type arguments will not be affected.
.TP
.B \-version
Print version information and exit.
.TP
.BI VOLHDR= name
Use
.I name
to generate a volume header.
.TP
.B \-w
Do interactive creation, extraction or renaming. 
For every file that matches the list of patterns and that has a more 
recent modification time in the
.B tar
archive (if in extract mode and
the \-U option is not specified) 
.B star 
prints its name and asks:
.RS
.IP
.B
get/put ? Y(es)/N(o)/C(hange name) :
.PP
You may answer either `N' for No or <Return> to skip this file.
If you answer `Y' the file is extracted or archived on tape with its 
original name.
If you answer `C', you are prompted for a new name. This name is used 
for the filename on disk if 
.B star 
is in extract mode or for the archive name if 
.B star 
is in create mode.
.sp
See
.B SECURITY NOTES
for more information.
.sp
Note that
.B \-w
is an interactive option that prevents
.B star
from being used in non-interactive environments.
.RE
.TP
.B \-wready
This option tells
.B Star 
to wait up to two minutes for the drive to become ready.
It has been added as a hack for a bug in the SunOS/Solaris
.I st
device driver. This driver has problems to sense the loading time 
with Exabyte drives with factory settings.
It also makes sense to use 
.B \-wready
if multiple remote backups are made. In this case, the remote connection
is closed while the remote tape server is still writing a file mark.
If another remote backup is initiated before the old remote server did
finish to write the file mark, it would be impossible to open the
tape driver unless
.B \-wready
is specified to tell
.B star
to wait for the drive to become ready again.
.TP
.B \-wtardumps
Tell 
.B star
to update the file that contains the tar dump dates data base if in dump mode.
If the dump is not a
.BR "full dump" ,
the tar dump dates data base file is not written.
See also
.BI tardumps= name
and
.B \-C
option or
.B "INCREMENTAL BACKUPS"
section for more information.
.TP
.BI \-X " filename"
Use the file
.I filename
as a file containing a list of path names to be excluded from the 
store/create/list/diff operation.
The file
.I filename
must contain a list of path names, each on a separate line.
Be careful with white space and note that path names in the list may not
contain new lines.
Multiple 
.B \-X
options may be used. Each argument must refer to a file containing path names.
The 
.B \-X
option has precedence before other options that select files to be included
in the operation.
See also
.B list=
option.
.TP
.B \-xattr
Reserved for NFSv4 extended attributes.
.TP
.B \-xattr\-linux
Store and extract extended file attributes as found on Linux systems.
This option only makes sense when creating or extracting 
.B exustar
archives as it is based on POSIX.1\-2001 extended tar headers.
.sp
The method used in the current implementation could be used to store and extract
extended file attributes from BSD too.
Note that the current implementation is not generic enough to cover more general
extended file attribute implementations as found on Solaris.
If
.B star
starts to implement a method that covers extended file attributes on Solaris,
the new method will be used then
.B \-xattr
has been specified and
.B \-xattr\-linux
will refer to the old method.
The method used with
.B \-xattr\-linux
may go away in the future.
.TP
.B \-xcopy
An alias for
.B \-copy \-sparse \-acl
.TP
.BI xdebug= "#, " xd= #
Set extended debug level to #.
.TP
.BR \-xdev ", " \-M
Do not descend mount points.
This is useful when doing backups of complete file systems.
See NOTES for more information.
.sp
When using
.BR \-find ,
this may not always work as expected, e.g. when the
.B /proc
filesyestem is involved.
Use
.B \-xdev
past
.B \-find
for this reason.
.TP
.B \-xdir
Extract directories even if the corresponding directories on the
archive are not newer.
This is useful when for some reason, the directories are recorded
after their content (see
.B \-dirmode
option), or when the permissions of some directories
must be set in any case.
As the classical UNIX
.B cpio
program does not implement delayed directory permission and time stamp setting,
.B cpio
users often create archives in reverse order (directories past their
content). For this reason, it makes sense
to use
.B \-xdir
while extracting
.B cpio
archives.
.TP
.B \-xdot
Unconditionally extract the first directory in the archive if the name of this
directory is either '.' or './'.
This helps to extract archives in an expected way if the target directory is
a newly created empty directory. As this directory is newer than the top level
directory in the archive,
.B star
would usually skip this directory during extraction.
The effect of this directory is as if
.B \-xdir
has been specified but is switched off after the first directory has been found.
.TP
.B \-xfflags
Store and extract extended file flags as found on BSD and Linux systems.
This option only makes sense when creating or extracting 
.B exustar
archives as it is based on POSIX.1\-2001 extended tar headers.
See NOTES section for problems with 
.B \-xfflags
on Linux systems.
.TP
.B \-xmeta
Extract 
.B "meta files"
as if they were files.
.B "Meta files"
in archives are plain files that do not contain any content data in the archive.
They may be created by using the
.B \-meta
option in
.B star's 
create mode.
Existing files are not overwritten. If a file is missing, a zero sized
file is created.
If the option
.B \-meta
is used together with the option
.BR \-force\-hole ,
missing plain files are created as sparse empty files of the original size.
.TP
.B \-xz
Run the input or output through a
.B xz
pipe.
See section
.B COMPRESSION
for details.
.TP
.B \-Z
Run the input or output through a 
.B compress
pipe.
See section
.B COMPRESSION
for details.
.TP
.B \-z
Run the input or output through a
.B gzip
pipe.
See section
.B COMPRESSION
for details.
.TP
.B \-zstd
Run the input or output through a
.B zstd
pipe.
See section
.B COMPRESSION
for details.
.SH COMPRESSION
.PP
In most cases,
.B star
automatically detects compressed archives and executes an appropriate
decompression program to assist it in extracting files from the archive.
The compressed archive is first passed to standard input of the
decompression program.
.B Star
reads the decompressed archive from standard output of the decompression
program and processes it as usual.
.PP
If the creation of a compressed archive is desired or if this mechanism
fails, the option
.BI compress-program= name
can be used to configure
.I name
as a compression/decompression helper.
Options
.BR \-7z ,
.BR \-bz ,
.BR \-freeze ,
.BR \-j ,
.BR \-lzip ,
.BR \-lzma ,
.BR \-lzo ,
.BR \-xz ,
.BR \-Z ,
.BR \-z ,
and
.BR \-zstd
are available as shorthands for the most common compression/decompression
helpers.
For all of these helpers,
.B star
is capable of detecting that a compressed file needs one of them to be
decompressed automatically.
.PP
Compression and decompression helpers are expected to be filters reading
from standard input and writing to standard output.
By default,
.B star
passes the sole option
.B \-d
to a decompression helper.
Compression helpers are started without any options.
Helper commands and options can be overridden using the
.IB name _CMD
options in sections
.B [compress]
and
.B [decompress]
of
.BR /etc/default/star.
See section
.B FILES
for details.
.PP
If the environment variable
.B STAR_COMPRESS_FLAG
is set, its contents are appended to the argument list for compression
helpers.
This is useful to pass a compression level to programs like
.BR gzip (1).

.SH "INCREMENTAL BACKUPS"
.PP
.B Star
is able to back up file system in full and incremental mode.
To allow incremental backups, the file system must implement
POSIX semantics.
.PP
To be more verbose:
.TP
.B \(bu
The filesystem needs to uniquely identify files by the two numbers
.B st_dev
(The filesystem ID or device ID of the device containing the file) and
.B st_ino
(The file serial number).
If a file is renamed, these numbers need to be retained.
Both numbers need to be a cardinal
scalar that is expressible in a decimal number.
.TP
.B \(bu
The filesystem needs to implement at least two time stamps,
.B st_mtime
the file's last modification time and
.B st_ctime
the file's last status change time.
Both time stamps need to be dealt with as documented by
the POSIX standard.
Both numbers need to be a cardinal
scalar that is expressible in a decimal number or as a decimal number
that counts in seconds plus another number that counts in fractions of
a second.
.TP
.B \(bu
The filesystem needs to allow renaming files
and directories by either calling
.BR rename(2),
or
.BR link(2)
and
.BR unlink(2).
.TP
.B \(bu
The filesystem needs to honor and preserve the case of file names.
.PP
The incremental backup method used by
.B star
depends on comparing the time stamps of all files against
the time of the last backup. Note that this method only works
correctly if the level 0 backup and all higher level 
incrementals include the whole file system.
As 
.B star
archives all inode meta data,
.B star
is able to detect renamed files by comparing the
.B "inode numbers"
of all files while in incremental restore mode.
.PP
Detecting renamed files only works if 
.BR star ,
while in backup mode,
scans the whole file system tree for each full and incremental backup.
This will work in case no files are excluded and the dump starts
at the root directory of a file system.
In case that no files are renamed from excluded parts to included parts,
partial backups may be taken also. Partial backups only make sense if
a complete directory sub tree is excluded (e.g. by using the
.B pat=
option) or if a partial backup starts at a sub directory that is not the
root directory of the file system.
.PP
In case of a partial backup, it is important that no file or directory will
ever be moved outside the scope and later move into the scope again. Moving
files or directories outside the scope of a partial backup is detected as
deletion and moving the files back into the scope does not make them
appear in an incremental backup since the time stamps of files from inside
renamed directories did not change.
.PP
Note that a backup must not include files that are mounted from another
filesystem and a restore cannot be done with more than one filesystem as
target.
.PP
Files in the backup tree that are hidden under a mount point cannot be
part of the backup as long as the backup is not done from a snapshot.
.PP
To create a level 0 dump call:
.PP
.B "star \-c \-xdev \-sparse \-acl \-link\-dirs level=0 \-wtardumps \e"
.br
.B "\ \ \ \ f=\fIarchive-name\fP \-C /\fIfilestem-mount-point\fP ."
.PP
To create a level 1 dump call:
.PP
.B "star \-c \-xdev \-sparse \-acl \-link\-dirs level=1 \-wtardumps \e"
.br
.B "\ \ \ \ f=\fIarchive-name\fP -C /\fIfilestem-mount-point\fP ."
.PP
Do not forget the dot at the end of the command line that specifies the
directory to start the operation.
.PP
Backups from live filesystems should be avoided.
On operating systems that support 
.BR "file system snapshots" ,
backups should be made from a read-only mount of a
snapshot. Be careful that all files that have been
created between setting up a snapshot and starting an
incremental backup may be missing from all backups unless the
.BI dumpdate= name
option is used.
.PP
If the system that is going to be backed up is not
acting as a file server, it makes sense to shut down
all services that may result in inconsistent file states
before setting up the filesystem snapshot. After the
filesystem snapshot has been set up, the services may be 
restarted.
.PP
If the the system that is going to be backed up is
acting as a file server, it may be that services
on remote clients cause inconsistent file states
unless all such services that remotely access files
are shut down before the snapshot is set up.
.PP
.B Star
includes options that help to deal with 
.BR "file system snapshots" .
The following example backs up a file system on Solaris using a
file system snapshot from UFS:
.PP
.B "echo > /tmp/snapstamp"
.sp
.B "mount -r `fssnap -F ufs -o \e"
.br
.B "\ \ \ \ backing-store=/var/tmp/EXPORT-NFS.snap /export/nfs` /mnt"
.sp
.B "star \-c \-xdev \-sparse \-acl \-link\-dirs level=0 \-wtardumps \e"
.br
.B "\ \ \ \ f=\fIarchive-name\fP dumpdate=/tmp/snapstamp \e"
.br
.B "\ \ \ \ fs-name=/export/nfs \-C /mnt ."
.PP
First a file with a current time stamp is created, then a snapshot for
/export/nfs is created and mounted on /mnt.
The following 
.B star
command then creates a level 0 backup from the file system using the
time the snapshot was created and the original mount point of the 
file system for /etc/tardumps and the archive header.
.PP
Note that if the backup is done on a live file system, it may be
unreliable. A typical problem problem in this context is caused
by growing log files.
As growing files are not a real problem with backups, the best way
of dealing with growing files is to set up a 
.B star
error control file (see
.B errctl=
option) and to tell
.B star 
to ignore growing files.
.SH "BACKUP SCHEDULES"
Full (level 0) dumps should be made on a regular base
(e.g. once a month).
As a full dump may take a long time and takes a lot of tape,
it is wise to make higher level incremental dumps with shorter intervals.
The next table shows a dump level list that may be used if
monthly full dumps take place:
.PP
.RS
.nf
.ta 12n 18n 24n 30n 36n 42n 48n
	\f2Sun 	Mon	Tue	Wed	Thu	Fri\fP
\f2Week 1:\f3	0	10	10	10	10	5
\f2Week 2:\f3	10	10	10	10	10	5
\f2Week 3:\f3	10	10	10	10	10	5
\f2Week 4:\f3	10	10	10	10	10	5
\f1
.fi
.RE
.DT
.PP
The level 10 dumps made between Monday and Friday accumulate all
changes made within the week, but you only need to restore the
latest level 10 dump in order to get all changes back.
If you don't like the size of the accumulated changes,
use the following backup schedule:
.PP
.RS
.nf
.ta 12n 18n 24n 30n 36n 42n 48n
	\f2Sun 	Mon	Tue	Wed	Thu	Fri\fP
\f2Week 1:\f3	0	20	30	40	50	5
\f2Week 2:\f3	10	20	30	40	50	5
\f2Week 3:\f3	10	20	30	40	50	5
\f2Week 4:\f3	10	20	30	40	50	5
\f1
.fi
.RE
.DT
.PP
Note that in this case, 7 dumps need to be restored if the
a crash happens at the worst case date (just before the Friday dump
in week 2 or later).

.SH "INCREMENTAL RESTORES"
Incremental restores should be made to an empty file system (except
for the 
.B lost+found
directory).
.B Star
is currently unable to perform incremental restores to a
file system that contains active mount points.
.PP
Incremental restores should be run as
.B root
user.
.B Star
supports private incremental dumps and restores run as an unprivileged user,
but this mode has been tested less frequently.
.PP
The incremental restore procedure starts with restoring the last
full (level 0) dump. Then the latest incremental dump of each
dump level (with ascending order of dump levels) need to be restored.
.PP
Let us assume the first example from the section 
.B "BACKUP SCHEDULES"
for the backup schedule. If a disk
crash happens before the Thursday dump of week 3 has been made,
the following restore procedure needs to be applied:
.TP
.B level 0
starting with an empty disk, the full (level 0) dump from week 1
is restored.
.TP
.B level 5
after the level 0 restore has been finished, the level 5 dump from
Friday in week 2 is restored.
.TP
.B level 10
after the level 5 restore has been finished, the level 10 dump from
Wednesday in week 3 is restored.
.PP
The disk now contains the same files as it did when the level 10
dump has been made on Wednesday of week 3.
.PP
To extract a level 0 dump call:
.PP
.B "cd /\fIextract-filestem-mount-point\fP"
.br
.B "star \-xpU \-restore f=\fIarchive-name\fP"
.PP
This creates the directory 
.B star-tmpdir
and the database
.B star-symtable
in the root directory of the new file system. 
Subsequent restores with higher level backups
depend on these files.
.PP
To extract a level 1 (or higher) dump call:
.PP
.B "cd /\fIextract-filestem-mount-point\fP"
.br
.B "star \-xpU \-restore f=\fIarchive-name\fP"
.PP
In order to restore a partial dump, the
.B \-partial
option needs to be specified. This is to make sure that the user understands
that renames to a path outside the scope of the partial dump may result in
inconsistencies during a restore.
.PP
In case there is a dump level mismatch or a reference date mismatch,
it is possible to give a restore a chance by specifying the
.B \-force\-restore
option.
.PP
Note that the environment variable
.B STAR_DEBUG
exists,
.B star
does not remove files with link count 1 that have been
removed between incremental dumps. These files are moved to the
directory
.BR star-tmpdir .
Before you start to extract the next
incremental, you need to remove all files in 
.BR star-tmpdir .

.SH "SYNCHRONIZING FILESYSTEMS"
.PP
.B Star
may be used to synchronize filesystem content.
To do this, an initial copy of the current content of the source
filesystem needs to be performed first.
.PP
To create an initial copy of a filesystem call:
.PP
.B "star \-c \-xdev \-sparse \-acl \-link\-dirs level=0 \-wtardumps \e"
.br
.B "\ \ \ \ \-C /\fIfilestem-mount-point\fP . | \e"
.br
.B "\ \ \ \ star \-xpU \-restore -C /\fIextract-target-dir\fP"
.PP
In order to perform subsequent synchronization of the target filesystem
with the content of the source filesystem, a modified incremental dump/restore
procedure may be used.
.PP
To copy incremental content of a filesystem call:
.PP
.B "star \-c \-xdev \-sparse \-acl \-link\-dirs level=1 \-wtardumps \e"
.br
.B "\ \ \ \ \-cumulative \-C /\fIfilestem-mount-point\fP . | \e"
.br
.B "\ \ \ \ star \-xpU \-restore -C /\fIextract-target-dir\fP"
.PP
Note that like with backups in general,
copies from a live filesystem should be avoided.
On operating systems that support 
.BR "file system snapshots" ,
copies should be made from a read-only mount of a
snapshot. Be careful that all files that have been
created between setting up a snapshot and starting an
incremental copy may be missing from all copies unless the
.BI dumpdate= name
option is used.
.PP
See section
.B "INCREMENTAL BACKUPS"
to learn how to modify the command line in case 
.B "file system snapshots"
are used.
.SH SIGNALS
.PP
If 
.B star 
handles a signal, it first prints the statistics. 
.B Star 
handles the following signals:
.TP 10
.B SIGINT
usually generated by ^C from the controlling tty. 
Upon receipt of a SIGINT, 
.B star 
prints statistics and exits. 
If in create mode i.e. storing files to archive, 
.B star 
finishes with the current file to ensure that no 
partial file is written to the archive, write an eof record and then exits.
.TP 10
.B SIGHUP
not to be generated from a tty. The actions are the same as upon receipt 
of a SIGINT.
.PD 0
.TP 10
.B SIGQUIT
.TP
.B SIGINFO
.PD
usually generated by ^\\ from the controlling tty.
Upon receipt of a SIGQUIT, 
.B star 
prints statistics and continues with the current operation. This is 
useful to watch the progress of the current operation.
.SH "EXIT STATUS"
The following exit values are returned. Note that the negative values are only
available to modern shells and programs that use
.BR waitid (2)
on a
.B POSIX OS
and thus can retrieve the full 32 bits of the
.B star
exit code. The positive number variants are what you get when only the low
8 bits from the exit code are available.
.TP
.B 0
All files were processed successfully.
.br
.ne 3
.TP
.B -64 / 192
An exit code has been used that does not fit into an 8-bit unsigned number
and the environment
.B COMERR_EXCODE
has not been set.
The value
.B -64 / 192
in this case marks a clash.
.br
.ne 3
.TP
.B -4 / 252
.B Star
has been interrupted in create mode and the end of star has been delayed
until the current file has been archived completely. This error is only
used in case that no other error occurred and the tar archive only has
become shorter than expected.
.br
.ne 3
.TP
.B -3 / 253
.B Star
has been called with the option
.BR \-e ,
or the
.B errctl=
option has been used to mark the current error fatal.
.br
.ne 3
.TP
.B -2 / 254
One or more files could not be processed successfully.
.br
.ne 3
.TP
.B -1 / 255
Command line parsing error.
.br
.ne 3
.TP
.B >0
Other positive exit codes: The
.B errno
of the call that caused the fatal error.
.SH EXAMPLES
.PP
To get a listing in a way similar to ls \-l one might use:
.IP
.B
example% star \-tv f=/dev/rmt/1bn
.PP
The same command as listed above in a 
.B "POSIX tar"
command line syntax compliant way is:
.IP
.B
example% star tvf /dev/rmt/1mbn
.PP
To copy the directory tree in
.I /home/someuser
to the directory
.I /home/fs
use:
.IP
.nf
.B 
example% (cd /home/someuser; star \-c .) | (cd /home/fs ; star \-xp)
.fi
.PP
or by using the change directory option of 
.BR star :
.IP
.B
.nf
example% star \-c \-C /home/someuser . | star \-xp \-C /home/fs
.fi
.PP
Note that both examples above are not the optimum way to copy a
directory tree. A more efficient way to copy a directory tree
is to use the
.B \-copy
option.
.IP
.nf
.B
example% star \-copy \-p \-xdot \-C /home/someuser . /home/fs
.fi
.PP
To copy a file tree including the 
.B "Access Control List"
entries for all files and to correctly copy sparse (holey) files use:
.IP
.B
.nf
example% star \-copy \-p \-xdot \-acl \-sparse \-C /home/someuser . /home/fs
.fi
.PP
To compare the content of a tape to the filesystem one might use:
.IP
.B
example% star \-diff \-v f=/dev/rmt/1bn
.PP
To compare two directory trees one might use:
.IP
.B
.nf
example% star \-c . | star \-C todir \-diff \-v diffopts=!times
.fi
.PP
or better by using a method similar to the
.B \-copy
method above:
.IP
.B
.nf
example% star \-c \-diff \-v diffopts=!times \-C fromdir . todir
.fi
.PP
To compare all properties of two file trees, use:
.IP
.B
.nf
example% star \-c \-diff \-vv \-dump \-acl \-sparse \-C fromdir . todir
.fi
.PP
To extract a backup of the /usr tree without all files residing below 
/usr/openwin one might use:
.IP
.B 
example% star \-xp \-V pat=openwin/\\* f=/dev/rmt/1bn
.PP
To extract all 
.I .c 
files to 
.BR src ,
all 
.I .o 
files to 
.B obj 
and all other files to /tmp one might use:
.IP
.B 
.nf
example% star \-xp \-C src '*.c' \-C obj '*.o' \-C /tmp '*' f=/dev/rmt/1bn
.fi
.PP
To extract files from a zipped
.B tar
archive that is located on a read only filesystem
e.g. a CD while having the shell's working directory on the CD one might use:
.IP
.B 
example% star \-zxp \-C /tmp f=star\-1.1.tar.gz
.PP
to extract the files from the
.B tar
archive to the /tmp directory.
.PP
To backup a list of files generated by the 
.BR find (1) 
command:
.IP
.B 
.nf
example% find . \fIfind_options\fP \-print | star \-c list=\- f=/dev/rmt/1bn
.fi
.PP
Note that this does not work if the file names from output of the
.B find 
command include new line characters.
.PP
To extract a
.I tarfile
that contains a
.I tarfile
one might use:
.IP
.B
.nf
example% star \-x \-to\-stdout f=/dev/rmt/1bn pat=\fIpat\fP | star \-xp
.fi
.PP
.I Pat, 
in this case should match the
.I tarfile
in the
.I tarfile
on tape that 
should be extracted.
.PP
To make a backup of the root filesystem to a tape drive connected to a 
remote machine, one might use:
.IP
.B
example# cd /
.br
.B
.nf
example# star \-cM fs=128m bs=63k f=tape@remotehost:/dev/rmt/1bn .
.fi
.PP
You need a line in /etc/passwd like the following to enable this:
.IP
.B
tape:NP:60001:60001:Tape:/etc/tapehome:/opt/schily/sbin/rmt
.PP
And a .rhosts file in /etc/tapehome to allow remote connections from 
the appropriate hosts.
Make sure that the file /etc/default/rmt exists and allows remote access
to the requested tape drive.
.PP
To use a faster 
.B rcmd(3)
connection for a backup to a remote tape server, one might use:
.IP
.B
example# env RSH='' star \-cM fs=128m bs=63k f=tape@remotehost:/dev/rmt/1bn .
.TP
Note that this requires root privileges.

.PP
To repair a corrupted filesystem for which no recent backup exists, 
do the following:
.IP
.B
example# fsck \-y /filesys
.br
.B
example# mount /filesys
.br
.B
example# cd /filesys
.br
.B
example# star \-xpk f=/dev/rmt/1bn
.br
.B
example# mt \-f /dev/rmt/1bn rewind
.br
.B
example# star \-diff \-v diffopts=!times f=/dev/rmt/1bn
.PP
Now check the differences and decide whether to restore additional 
files. This may be done by generating a list containing the needed 
filenames and using the list= option or by using the interactive mode 
(see \-w option).
.PP
If you want a list that only contains all filenames from files with
differences you may use:
.IP
.B
example# star \-diff \-tpath diffopts=!times f=/dev/rmt/1bn
.PP
If you are looking for files that changed the type or the access permission
because this is a common case on still corrupted files, use:
.IP
.B
example# star \-diff \-tpath diffopts=type,perm f=/dev/rmt/1bn
.PP
If you like to archive all directories only that are part of the directory
tree under ".", use:
.IP
.B
example# star \-c f=\fIarchive-name\fP \-find . \-type d
.PP
If you like to archive all files as owner root and group root and
make all files world readable in the archive, use:
.IP
.B
example# star \-c f=\fIarchive-name\fP \-find . \-chown root \-chgrp root \-chmod o+r
.PP
If you like to archive all files with a mtime of
.BR now ,
use:
.IP
.B
example# star \-c f=\fIarchive-name\fP \-find . \-chmtime now
.PP
If you like to list all files in an archive in a way like
.BR sfind (1),
instead of the way used by star, use:
.IP
.B
example# star \-t f=\fIarchive-name\fP \-find . \-ls \-false
.PP
If you like to split the content of an archived tree into tar chunks
of 1 GB, you could call:
.sp
.RS
.nf
.B
example# star \-c f=/tmp/v.tar tsize=1G \e
.br
.B
new\-volume\-script='sh \-c "mv /tmp/v.tar /tmp/v$(($1-1)).tar" nv' .
.fi
.RE

.SH ENVIRONMENT
.TP
.B COMERR_EXCODE
If this environment is present, exit codes are not mapped to avoid possible
clashes with calling programs that use the outdated
.BR waitpid (2)
instead of the
.BR waitid (2)
call to wait for the exit status from
.BR star .
While
.BR waitid (2)
returns the full 32 bit exit code,
.BR waitpid (2)
masks the exit code with 0377.
Without the environment
.BR COMERR_EXCODE ,
exit codes outside the range
.B -63\ ..\ 191
are mapped to
.BR -64 " (" 192 )
to mark a clash.
.sp
If the environment
.B COMERR_EXCODE
is set and the value starts with the character '0', an exitcode code > 0
that leads to
.BR "exitcode & 0377 == 0" ,
is mapped to
.B -64
to avoid confusion with shells that use
.BR waitid (2)
but interpret these exit codes as zero with respect to conditional execution
in order to implement compatibility to historical shells.
.sp
With a shell that supports the full exitcode on and a POSIX compliant
operating system, it is recommended to set the environment
.BR COMERR_EXCODE .
.TP
.B STAR_COMPRESS_FLAG
If you like
.B star
to always create compressed files that use maximum compression, you may set
the environment variable
.B STAR_COMPRESS_FLAG
to \-9.
.TP
.B STAR_DEBUG
If this environment variable is present,
.B star
will not remove temporary files from
.BR ./star-tmpdir . 
The files in this directory are files that have been removed by users
before the last incremental dump did take place on the master filesystem.
.TP
.B STAR_FIFOSIZE
If you like to by default let 
.B star
use a different fifo size, set this environment variable to the desired size.
.TP
.B STAR_FSYNC
If set to
.RB ` N ',
the default behavior of
.B star
is as if the
.B \-no\-fsync
option has always been specified.
.sp
This grants that
.B star
is always faster than other archivers, but makes it impossible for
.B star
to check whether the extraction of a file to the filesystem was successful.
.sp
If set to any other value, 
the default behavior of
.B star
is as if the
.B \-do\-fsync
option has always been specified.
.sp
The environment
.B STAR_FSYNC
has precedence over
.B /etc/default/star
but may still be overwritten by command line options.
.TP
.B STAR_NOHINT
If this environment is seen, some informative messages are not printed.
this currently applies to messages related to
.B STAR_FSYNC
and
.BR STAR_SECURE_LINKS .
.TP
.B STAR_SECURE_LINKS
If set to
.RB ` N ',
the default behavior of
.B star
is as if the
.B \-no\-secure\-links
option has always been specified.
.sp
This disables checks for potentially insecure links by default.
.sp
If you like to make this the default, keep in mind that you need to specify
.B \-secure\-links
in case you like to unpack an archive from unknown sources.
.sp
The environment
.B STAR_SECURE_LINKS
has precedence over
.B /etc/default/star
but may still be overwritten by command line options.
.TP
.B STAR_WORKAROUNDS
If this environment variable is present,
implement workarounds for named problems.
The environment variable is expected to contain a comma separated list of
bug names:
.RS
.TP
.B ssh-tcpip
implement a workaround for a bug caused by
.B ssh
or
.B TCP-IP
seen on Linux in 2003.
The bug caused the verbose output from
.B star
on
.B stderr
to be lost when calling something like:
.sp
.B "    ssh \c"
.I host \c
.B 'star -c ...'
.sp
The workaround is activated when
.B stderr
is not connected to a terminal and works by waiting for 0.1\ seconds
for the output to appear.
.RE
.TP
.B TAPE
Unlike other
.BR tar (1)
implementations, 
.B star
defaults to use stdin/stdout for the archive.
If you like 
.B star
to use the file name from the
.B TAPE
environment instead, you need to specify the
.B \-T
option too.
.TP
.B RSH
If the 
.B RSH
environment is present, the remote connection will not be created via
the default method, but rather uses the program specified by
.BR RSH .
Use e.g. 
.BR RSH= /path/to/ssh
to create a secure shell connection using a specific
.B ssh
version.
.sp
If the
.B RSH
environment is not present, the compiled in default is used.
This currently is
.BR ssh .
.sp
If the
.B RSH
environment is empty, then 
.BR rcmd (3)
is used.
.sp
Former versions of
.B star
by default did use
.BR rcmd (3)
to create a remote connection.
Using a different method forces 
.B star
to create a pipe to the 
.B rsh(1)
or
.B ssh (1)
program and disallows
.B star
to directly access the network socket to the remote server.
This makes it impossible to work at maximum performance and slows down
the connection compared to a 
.B root
initiated
.B rcmd(3)
connection.
.sp
See
.B rsh= 
option for more information.
.sp
See BUGS section for more information.
.TP
.B RMT
If the 
.B RMT
environment is present, the remote tape server will not be the program
.B /etc/rmt
but the program pointed to by
.BR RMT .
Note that the remote tape server program name will be ignored if you log in
using an account that has been created with a remote tape server program as
login shell.
.sp
See
.B rmt= 
option for more information.
.SH FILES
.TP
.B "/etc/default/star"
Default values can be set for the following options in /etc/default/star.
For example:
.SM CDR_FIFOSIZE=64m
.RS
.TP
.B STAR_FIFOSIZE
Sets the default size of the FIFO (see also 
.BR fs= #
option).
.TP
.B STAR_FIFOSIZE_MAX
Sets the maximum size of the FIFO (see also 
.BR fs= #
option).
Setting 
.B STAR_FIFOSIZE_MAX
in
.B "/etc/default/star"
allows one to overwrite global values from backup scripts for machines
with less memory.
.TP
.B STAR_FSYNC
If set to
.RB ` N ',
the default behavior of
.B star
is as if the
.B \-no\-fsync
option has always been specified.
.sp
This grants that
.B star
is always faster than other archivers, but makes it impossible for
.B star
to check whether the extraction of a file to the filesystem was successful.
.sp
This setting is overwritten by the
.B STAR_FSYNC
environment, if present.
.sp
If you like to make the default fast, keep in mind that you need to specify
.B \-do\-fsync
for cases where
.B star
needs to be able to know whether the extraction was successful.
.TP
.B STAR_SECURE_LINKS
If set to
.RB ` N ',
the default behavior of
.B star
is as if the
.B \-no\-secure\-links
option has always been specified.
.sp
This disables checks for potentially insecure links by default.
.sp
This setting is overwritten by the
.B STAR_SECURE_LINKS
environment, if present.
.sp
If you like to make this the default, keep in mind that you need to specify
.B \-secure\-links
in case you like to unpack an archive from unknown sources.
.TP
.B archive0=
.TP
.B archive1=
.TP
.B archive2=
.TP
.B archive3=
.TP
.B archive4=
.TP
.B archive5=
.TP
.B archive6=
.TP
.B archive7=
Archive entries for the 
.B \-[0..7]
option.
.sp
A correct 
.B archive?=
line has 3..4 space separated entries.
The first is the device entry (e.g. 
.IR archive0=/dev/tape ).
The second is the blocking factor in 512 byte units.
The third is the maximum media size in 1024 byte units.
If this entry contains a 0, then the media size is unlimited.
The fourth entry is optional. If it contains a 'n' or a 'N',
then the archive device is not a tape.
.sp
Examples:
.sp
archive0=/dev/tape 512 0 y
.br
archive1=/dev/fd0 1 1440 n
.br
archive2=/dev/rmt/0mbn 512 0
.sp
If the default file does not need to be shared with the tar program from
Solaris, any number may be used like a generic size option like bs=.
.sp
Example:
.sp
archive0=/dev/tape 256k 40G y
.TP
.BR [compress] ", " [decompress]
Compression/decompression helpers.
For each program passed via option
.BI compress-program= name
a helper can be defined with option
.IB name _CMD
in the appropriate section.
This helper is ran instead of
.IR name ,
permitting you to use a program with a different name or to pass
different options from the defaults (see section
.B COMPRESSION
for details).
This feature is currently not available on DOS (DJGPP).
.sp
The following example defines a compression/decompression helper for the
PKZIP format, passing archives through
.BR zip (1)
or
.BR unzip (1)
as appropriate:
.sp
[compress]
.br
ZIP_CMD=zip -9
.sp
[decompress]
.br
ZIP_CMD=unzip
.RE
.TP
.B "/etc/tardumps"
The default name for the dump level archive. The default name is used 
whenever the
.BI tardumps= name
option has not been specified.
The file is written or updated when
.B \-wtardumps
is used.
.sp
The file holds one or more lines, each specifying a dump level entry.
Each dump level entry starts with a mount point name followed by a
TAB and one or more spaces, followed by the decimal dump level, a space and
the dump time.
.sp
If the dump level is directly followed by a 'P', then the dump refers to
a partial dump (a dump that does not include the whole filesystem).
.sp
The dump time itself includes the decimal representation of the UTC seconds
since Jan 01 1970, a space and the textual local time representation of the
dump time.
.sp
The numerical decimal dump time representation may be followed by a dot and
a sub second value.
The textual local time representation is for informational use by humans only
and not evaluated by
.BR star .
.TP
.B ./star-symtable
Contains a database that is needed in incremental restore mode.
.TP
.B ./star-symdump
Contains an intermediate dump of restore database after a fatal error
condition was met during an incremental restore operation.
.TP
.B ./star-tmpdir
Is the temporary directory that is used as intermediate file storage by
.B star
if in incremental restore mode.
.TP
.B ./star-lock
Is a lock file created by star when doing an incremental restore.
If this file is present, it prevents
.B star
from running another incremental restore operation. This helps to
avoid more than one restore operation at a time (e.g. from a
cron script).
.TP
.B "/dev/tty"
Is used for the interactive user interface.
.SH "SEE ALSO"
.BR spax (1), 
.BR suntar (1), 
.BR scpio (1), 
.BR tar (1), 
.BR cpio (1), 
.BR pax (1), 
.BR rcp (1), 
.BR mt (1),
.BR rmt (1), 
.BR match (1), 
.BR dd (1), 
.BR sdd (1), 
.BR rsh (1),
.BR ssh (1),
.BR star_sym (1),
.BR tartest (1),
.BR star (5),
.BR rcmd (3),
.BR fssnap (1m),
.BR waitid (2),
.BR waitpid (2)
.SH DIAGNOSTICS
star: f records + p bytes (total of x bytes = d.nnk).
.PP
The number of full records, the number of bytes in partial records
and the total amount of data in KBytes.
.PP
star: Total time x.yyysec (z kBytes/sec)
.PP
The time used and the transfer speed from/to the archive.
.PP
If there have been non fatal errors during the archive processing,
.B star
will display a delayed error summary before exiting.

.SH NOTES
.PP
The command line syntax for the tar command (as defined in SUSv2 - UNIX-98)
deviates from the command line syntax defined for all other commands. While the 
.B "POSIX command line syntax"
requests
all options to start with a dash (\-) and allows one to either write options separately
or combined (in case of boolean flags), the
.B tar
command line syntax
requires all options to be combined into a single string that does not start with
a dash.
.B Star
by default assumes a command line syntax like a typical POSIX command and includes
a compatibility mode that allows one to specify a command line syntax as documented
for the 
.B UNIX-98 tar
command.
If you believe that you found a bug in the way 
.B star
parses the command line, please first check your command line for correctness before
you make a bug report for
.BR star .
.PP
If you like to write portable shell scripts that call tar, use the 
.B UNIX-98 tar
command line syntax (i.e. a single option string and no dash), choose the
commands and options from the following set of characters (
.I "rxtuc vxfblmo"
) and check the shell script with both, your local tar and
.B star
for correct behavior. It you expect the script to call gnutar, do not include
the
.B \-o
option as gnutar implements this option in a way that violates UNIX-98.
.PP
.B Star 
strips leading ./ sequences from pathnames. This lets 
.B star 
in many cases store longer pathnames than other implementations.
.PP
The POSIX.1\-1988 method (ustar format) of storing files with pathnames that are 
longer than 100 chars has some limitations:
.IP
The name field (100 chars) an inserted slash (`/') 
and the prefix field (155 chars) produce 
the pathname of the file. When recreating the original filename, 
name and prefix are concatenated, using 
a slash character in the middle. If a pathname does not fit in the 
space provided or may not be split at a slash character so that the 
parts will fit into 100 + 155 chars, the file may not be archived. 
Linknames longer than 100 chars may not be archived too.
.PP
The 
.IR star ,
.IR xstar ,
.IR xustar ,
.IR exustar ,
.IR pax ,
and
.I gnutar
archive formats don't have these limitations. While gnutar uses a 
method that makes it impossible for other
.B tar
implementations (except 
.BR star ) 
to restore filenames that are longer than 100 chars, the
.IR xstar ,
.IR xustar ,
.IR exustar
and
.IR pax / epax
archive format uses a method that allows an POSIX.1\-1988 compliant way of 
storing filenames, if the POSIX method would allow this.
When the archive format is
.IR xustar ,
.IR exustar
or
.IR pax / epax
very long filenames are stored using extended headers from the POSIX.1\-2001 standard.
.PP
Some buggy
.B tar
implementations will generate incorrect filenames 
during a restore operation if the archive contains pathnames or linknames of 
exactly 100 chars length.
.PP
.B Star
adds a 
.I tar
signature in the last four bytes of each
.B tar
header if the archive format is
.I star
or
.IR xstar .
This is no problem
with the 
.B star 
archive format as it is an extension of the old pre POSIX.1\-1988 tar format.
On the other side, the 
.B xstar
archive format claims to be as POSIX.1\-1988 compliant as possible. 
Inserting this 
.I tar 
signature is a minor deviation from the standard that has the last 12 bytes
of each header reserved for future use. On the other side,
.B tar
implementations
such as some
.B pax
implementations that only compute checksums on the first 500 bytes of the header
are violating the standard that requests the checksum to be computed on all
512 bytes of the tar header. All
.B tar
implementations that are 100% Posix
compliant will be able to extract 
.B xstar 
archives as long as no new standard is defined that claims the last 12 bytes
of the header for a different use.
But then the 
.B "ustar version"
number should be changed from `00'
to `01'.
Now, that the POSIX\-2001 standard has been accepted, it is even predictable
that all extensions to the standard
.B tar
format will go into the POSIX.1\-2001 extended headers
which are extensible to include any feature without future limitation.
The only known
.B tar
implementation that also uses the last 12 bytes of the
.B tar
header is Sun's
.B tar
which uses these 12 bytes for files that are split over
several archives. Such archives created by Sun's tar are not 
readable by the buggy 
.B pax
implementation too. The Sun extension is not incompatible to the 
.B star 
signature because Sun expects an octal number at the beginning of the
12 byte field which is a null character in the
.B star
case.
.PP
.B Star
uses these four bytes since 1985 without problems.
If you need a 100% POSIX.1\-1988 and 100% POSIX.1\-2001 compliant tar archive,
you may use the
.IR xustar ,
.IR exustar
or the
.IR pax / epax
archive format.
The probability of falsely detecting other
.B tar
formats as 
.B xustar 
or
.B exustar
format however is higher.
.PP
There is no way to ask for the 
.IR n \-th
occurrence of a file.
.PP
The way EOF is handled by 
.B star
differs, whether the fifo is in effect or not.
If the fifo is not used, 
.B star 
stops reading the archive if it 
encounters a logical EOF record in the archive. 
If the fifo is used, 
.B star 
may read until the fifo is full or until the real EOF mark on tape is reached.
How much data 
.B star actually reads depends on the time when the 
.B star
foreground process sends a fifo shutdown signal to the background fifo read
process.
.PP
Gnu tar often creates
.B tar
archives with incorrect logical EOF marks.
The standard requires two blocks that are completely zeroed, whereas gnutar
often only adds one of them.
.PP
Old versions of
.B tar
found on SYSVr3 and earlier cannot read
.B tar
archives 
with a blocksize greater than 10\ kBytes.
.PP
The method of storing 
.I sparse
files currently used with the 
.I star
and
.I xstar
format is not guaranteed to be used in later versions of 
.BR star .
If the author decides to change this method, later versions of 
.B star 
may not be able to restore sparse files from
.B tar 
archives made by the current version of 
.BR star .
.PP
Some
.B tar
implementations violate the standard in using only the first 500 
Bytes of the header for checksum computation. These
.B tar
implementations 
will not accept 
.I star 
and 
.I xstar
type
.B tar
archives.
.PP
Sun's Solaris 2.x
.B tar
implementation violates the Posix standard. Tar 
archives generated by 
.B star
cause Sun's
.B tar
to print tar: impossible file type messages. You may 
ignore these messages.
.PP
Gnutar's dumpdirs are non standard and are currently not implemented.
.PP
If gnutar archives sparse files with more than four holes, it produces 
archives that violate the standard in a way that prevents other
.B tar
implementations to read these archives. 
.B Star 
knows about that and is able to handle these gnutar archives.
.PP
The filetype 
.I N
(LF_NAMES) from gnutar (an obsolete method of storing long names) will never be 
implemented.
.PP
Note that on operating systems (like DOS) that do not implement real pipes,
.B star
implements compression via a temporary file.
Using compression thus is limited by the maximum file size and the available
disk space.
.PP
The extended file flags implementation (see
.B \-xfflags
option)
on Linux is buggy by design.
In order to retrieve the needed information, every file needs to be opened.
If the /dev directory is included in create mode, every possible driver will be
loaded which may hang the system for a long time. In the worst case, unwanted
side effects from opening devices (such as causing tape drives to rewind the media)
may be caused.

.SH "SECURITY NOTES"
If you unpack a tar archive in a non empty directory, any file in that directory 
may be overwritten unless you specify the 
.B \-k
option.
If the archive contains symbolic links or hard links, 
.B star
may even overwrite files outside the current directory.
If the directory where the archive is been unpacked is not empty and
contains contains symbolic links or hard links to directories outside that
directory,
.B star
may also overwrite files outside the current directory.
As many other commands, 
.B star
usually has all possible permissions when run as root.
Unpacking archives as root thus may have fatal results to any file on your system.
Be very careful when you try to extract an archive that has not been
created by you. It is possible to create hand crafted tar archives that may overwrite
critical files (like /etc/passwd) on your system.
In addition all tar archives that have been created with the 
.B list=
option and tar archives where the
.B C=
option was not specified before all file type arguments may be critical.
.PP
A good advise is to extract all doubtful archives as non root in an empty
directory and to neither specify the 
.B \-/
nor
.B \-..
or
.B \-no\-secure\-links
options.
If you get a warning, you should unpack the archive a second time and specify the
options
.BR \-k ", " \-w " and " \-nowarn
in addition to the options used for the first run.
.LP
See the 
.B ENVIRONMENT
section and
.B /etc/default/star
for ways to configure the default behavior.
.SH SUID NOTES
If 
.B star
is installed suid root, 
.B star
is able to make connections to remote archives for non root users. 
This is done by using the
rcmd(3) interface to get a connection to a rmt(1) server.
.PP
.B Star
resets its effective uid back to the real user id immediately after setting up
the remote connection to the rmt server and before opening any other file.
.PP
If
.B star 
has not been installed suid root and not called by root, it will try to create
the remote connection via
.B rsh(1)
or
.B ssh(1)
(in case the environment
.B RSH
has been set to
.BR ssh ).
Note that in this case, the throughput to the remote tape server will be much
lower than with a connection that has been initiated via
.BR rcmd(3) .
.SH LIMITATIONS
If
.B star
is running on a large file aware platform,
.B star
is able to handle files up to 8 GB in a mode that is compliant to the POSIX.1\-1988
.B ustar
format. With a nonstandard 
.B star
specific extension, up to 95 bits may be used to code the filesize.
This will handle files up to 200,000,000 TB.
With the new POSIX.1\-2001 extended headers
used by the
.IR xustar ,
.I exustar
and
.IR pax / epax
format, any filesize may be archived.
.SH BUGS
The fact that the 
.B \-f
option has to be implemented in a way that is compatible with old tar 
implementations gives several problems.
The options
.BR \-fifostats ,
.BR \-force\-hole ,
.B \-force\-remove
and
.B \-fifo
interfere with the
.B \-f
option and the fact that they exist prevents users from using filenames like
e.g.
.B ifo
using the traditional way where the filename directly follows the string
.B \-f
without any space between the option name and the file name.
However, there is no problem to use a file named
.B ifo
by by calling 
.BR "\-f ifo" ,
.BR f=ifo ,
.BR \-f=ifo
or
.BR "\-f= ifo" .
Be careful not to make typos with the above options. The result could be
that a file is created as a result of the mistyped option.
.PP
There is currently no way to set the fifo lowwater and highwater marks.
.PP
If you ever discover a hang in the
.B fifo
of star, get the process ids for both star processes, send both a
.B RTMAX
signal using
.BR kill (1)
and report the diagnostic output.
.PP
There is currently no way to automatically delete files in the target file tree
if they are obsolete.
.B Star 
should implement something similar to gnutar's dumpdirs.
.PP
If not invoked by the super user 
.B star 
may not be able to extract files 
if they reside in read only directories.
.PP
.B Star 
is not able to make a complete backup of a filesystem if files 
are hidden by a mount that is in effect on a directory of this 
filesystem.
This may be avoided in case of the ufs filesystem 
if the backup is made off a ufs snapshot (see the man page for
.BR fssnap (1m)
It could be avoided for any filesystem if the loopback filesystem had an 
option that tells 
.I lofs 
not to traverse mountpoints.
.PP
For now (late 2002), we know that the following programs
are broken and do not implement signal handling correctly:
.TP
rsh
on SunOS-5.0...SunOS-5.9
.TP
ssh
from ssh.com
.TP
ssh
from openssh.org
.LP
Sun already did accept a bug report for 
.BR rsh (1) / ssh(1) . 
Openssh.org accepted and fixed
a bug for their implementation of 
.BR ssh (1).
.LP
If you use 
.B star
to create a remote connection via an unfixed
.BR rsh (1)
or 
.BR ssh (1),
be prepared that terminal generated signals may interrupt the
remote connection.

Mail other bugs and suggestions to
.B schilytools@mlists.in-berlin.de
or open a ticket at
.BR https://codeberg.org/schilytools/schilytools/issues .
.PP
The mailing list archive may be found at:
.PP
.nf
.BR https://mlists.in-berlin.de/mailman/listinfo/schilytools-mlists.in-berlin.de .
.fi

.SH HISTORY
A
.B tar
command appeared in Seventh Edition Unix, which was released in
January, 1979. It replaced the
.B tp
program from Fourth Edition Unix which replaced the
.B tap
program from First Edition Unix. 
.LP
.B Star
was first created in 1982 to extract tapes on a UNIX clone
.RB ( UNOS )
that had no
.B tar
command.
In 1985 the first fully functional version has been released as 
.B mtar.
.PP
When the old 
.B star 
format extensions have been introduced in 1985, it was renamed to 
.B star
(Schily tar).
In 1994, Posix 1003.1\-1988 extensions were added and 
.B star 
was renamed to 
.B star
(Standard tar).

.SH AUTHORS
.nf
J\*org Schilling and the schilytools project authors.
.fi
.SH "SOURCE DOWNLOAD"
The source code for
.B star
is included in the
.B schilytools
project and may be retrieved from the
.B schilytools
project at Codeberg at
.LP
.BR https://codeberg.org/schilytools/schilytools .
.LP
The download directory is
.LP
.BR https://codeberg.org/schilytools/schilytools/releases .
